<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><script>
            const cachedTheme = localStorage.getItem('theme');
            if (cachedTheme) {
              document.documentElement.dataset.theme = cachedTheme;
            } else {
              const preferredTheme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
              document.documentElement.dataset.theme = preferredTheme;
            }
            </script><style data-href="/styles.454251d7084ae95f11ab.css" data-identity="gatsby-global-css">.modal-wrapper{align-items:center;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);background:rgba(0,0,0,.6);bottom:0;display:flex;justify-content:center;left:0;position:fixed;right:0;top:0;z-index:999}.modal-content-wrapper::-webkit-scrollbar{width:0}.modal-content{background:var(--background-color);border:1px solid var(--card-background-border-color);border-radius:1rem;max-width:1080px;min-width:600px;padding:1.5rem;position:relative;width:50vw}.modal-content-wrapper{max-height:70vh;min-height:50vh;overflow-y:auto;width:100%}.modal-closer{cursor:pointer;font-size:1.2rem;position:absolute;right:.8rem;top:.8rem}.modal-closer:hover{color:var(--blue)}@media (max-width:900px){.modal-content{min-width:90%;width:90%}}.post-card-img{background-color:var(--background-color);border-radius:12px;bottom:0;box-shadow:0 0 6px rgba(0,0,0,.15);height:200px;left:50%;-o-object-fit:cover;object-fit:cover;position:absolute;-webkit-transform:translate(-50%) rotate(-8deg);transform:translate(-50%) rotate(-8deg);transition:.2s;width:300px}.img-line{height:120px;margin-bottom:2rem;position:relative}.post-card{align-items:center;border:1px solid var(--card-background-border-color);border-radius:1.5rem;cursor:pointer;display:flex;flex-direction:column;justify-content:center;margin:140px auto 0;max-width:45rem;padding:1.5rem 2rem;position:relative;transition:.2s}.post-card:hover{box-shadow:0 0 1rem var(--card-box-shadow)}.post-card:active{box-shadow:0 0 1.5rem var(--blue)}.post-card:hover .post-card-img{-webkit-transform:translate(-50%) rotate(0deg);transform:translate(-50%) rotate(0deg)}.post-card h2:after{background:var(--blue);content:"";display:block;height:2px;margin-left:auto;margin-right:auto;margin-top:10px;width:60px}.post-card-meta{background-color:var(--card-background-color);border:1px solid var(--card-background-border-color);border-radius:.5rem;font-size:.9rem;font-weight:300;margin:1rem 0 0;padding:5px 10px}@media (max-width:500px){.post-card{padding:1.5rem .8rem}}.article-navigator{background-color:var(--background-color);border-right:1px solid var(--card-background-border-color);height:100vh;overflow-y:auto;padding:2.5rem 1.2rem 2.5rem 2rem;position:-webkit-sticky;position:sticky;top:0;-webkit-user-select:none;-ms-user-select:none;user-select:none;width:20%}.article-navigator::-webkit-scrollbar{width:0}.article-navigator-visible{-webkit-transform:translateX(0)!important;transform:translateX(0)!important}@media (max-width:1100px){.article-navigator{-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);background-color:var(--background-color-transparent);border:none;box-shadow:0 0 8px rgba(0,0,0,.1);height:100%;left:0;left:auto!important;max-width:400px;padding:0;position:fixed;-webkit-transform:translateX(-100%);transform:translateX(-100%);transition:.3s;width:calc(100% - 80px);z-index:10}.article-navigator h4{font-size:1.2rem!important;margin-top:1rem!important;padding-left:1rem;padding-right:1rem}.article-navigator p{border-bottom:1px solid var(--navigator-border-color);font-size:1rem!important;line-height:2.8rem!important;padding-left:2rem!important;padding-right:2rem!important;transition:background .3s}.article-navigator p:hover{background:var(--navigator-hover-color)}.article-navigator-switch{visibility:visible!important}}.article-navigator h4{font-size:15px;margin-bottom:.5rem;margin-top:1rem}.article-navigator h4:first-child{margin-top:0}.article-navigator-switch{background-color:var(--background-color);border:1px solid var(--card-background-border-color);border-radius:50%;color:var(--font-color);cursor:pointer;font-size:.8rem;height:30px;left:.5rem;line-height:29px;position:fixed;text-align:center;top:4.5rem;visibility:hidden;width:30px;z-index:9}.article-navigator p{cursor:pointer;font-size:14px;margin:0;overflow-x:hidden;padding-left:.5rem;text-overflow:ellipsis;white-space:nowrap;width:100%}.article-navigator p:hover,.highlighted-navigator-item{color:var(--blue)}.item-list{align-items:center;border-left:3px solid var(--blue);display:flex;flex-direction:column;justify-content:center;margin:0 auto 0 1rem}.item-list .item{margin:0;padding:1rem;position:relative;width:100%}.item:before{background-color:var(--blue);border-radius:50%;content:"";height:.8rem;left:-.5rem;position:absolute;top:2rem;transition:.2s;width:.8rem}.item:hover:before{-webkit-transform:scale(1.2);transform:scale(1.2)}.item-list .item-label{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;font-size:15px;font-weight:400}.item-list .item-content{padding-top:.5rem}.homepage-title{font-weight:700;margin:2rem 0 1rem}.item a{transition:.3s}.item a:hover{color:var(--font-color-highlight)}@media (max-width:750px){.base-wrapper[name=article-wrapper]{padding:2.625rem 0}.base-wrapper,.base-wrapper[name=article-wrapper]{margin-left:auto;margin-right:auto;min-height:100%;width:100%}.base-wrapper{margin-top:64px;padding:2.625rem 1rem}.not-found-background{aspect-ratio:9/20;user-select:none}}.messager{background-color:var(--background-color);border:1px solid var(--card-background-border-color);border-radius:.5rem;box-shadow:0 0 .8rem var(--card-box-shadow);left:0;margin-left:auto;margin-right:auto;max-width:200px;padding:.5rem 1rem;position:fixed;right:0;text-align:center;top:1rem;-webkit-transform:scale(.2);transform:scale(.2);transition:.2s;z-index:1000}.footer{background-color:#212121;color:#efefef;font-size:15px;height:184px;justify-content:space-evenly;position:relative;-webkit-user-select:none;-ms-user-select:none;user-select:none}.footer,.footer .wrapper{display:flex;flex-direction:row}.footer .wrapper{align-items:center;justify-content:space-around;padding:.5rem;width:100%}.footer .wrapper div{margin:0 8px}.footer h3{font-size:1.6rem;font-weight:lighter;margin-top:8px;width:100%}.footer p{line-height:1.2rem;margin:0;padding:.5rem 0;text-align:center}.footer span{cursor:pointer;font-size:1.6rem;margin-right:12px}.wrapper li{padding:4px 0}.footer span:hover{color:var(--blue)}@media (max-width:750px){.footer .wrapper{flex-direction:column!important;margin-bottom:1rem;width:100%}}.navbar{background-color:#212121;box-shadow:0 0 1rem rgba(0,0,0,.1);font-family:Lato,Georgia,serif;height:64px;min-width:350px;padding:12px 0;-webkit-user-select:none;-ms-user-select:none;user-select:none;width:100%}.navbar nav{align-items:center;display:flex;flex-direction:row;justify-content:space-evenly;max-width:1080px;min-width:375px;width:64%}.nav-link .img-label{font-size:15px;min-width:54px;padding-left:2px}@media (max-width:750px){.navbar{position:absolute;z-index:10}.nav-link .img-label{display:none}}.nav-link{align-items:center;color:#fff;cursor:pointer;display:flex;flex-direction:row;font-size:2.2rem;justify-content:center;margin:0 1rem;min-width:3rem;transition:.2s}.nav-link>img{border-radius:50%;display:inline-block;height:2rem}.nav-link:hover{color:var(--blue);text-decoration:none}.nav-link .link-label{display:block;font-size:16px;text-align:center;width:8rem}.link-active{color:var(--blue)}.game .question{margin:1.5rem 0}.game .question input{-webkit-appearance:none;appearance:none;background:none;border:none;border-bottom:1px solid var(--font-color);color:var(--font-color);display:inline-block;font-weight:700;max-width:120px;outline:none;padding:1px 8px}.game .question button{background:var(--card-background-color);border-radius:4px;color:var(--font-color);cursor:pointer;font-size:12px;margin-left:8px;padding:2px 6px}.game img{aspect-ratio:16/9;border-radius:8px;height:auto;margin-bottom:.5rem;margin-top:1rem;overflow:hidden;padding:0;width:100%}.game img,.lamp{position:relative}.lamp{--lamp-lightness:60%;--lamp-color:hsl(0deg 0% var(--lamp-lightness));--outline-offset:var(--sp--3);--outline-color:#fff;background-color:transparent;cursor:pointer;height:45px;-webkit-transform:scale(.711);transform:scale(.711);-webkit-transform-style:preserve-3d;transform-style:preserve-3d;width:45px}.lamp>*{display:block}.lamp-base{background-color:var(--lamp-color);border-radius:4px 4px 0 0;bottom:0;box-shadow:inset 0 .5px 2px rgba(0,0,0,.6);height:7px;position:absolute;right:5px;-webkit-transform-style:preserve-3d;transform-style:preserve-3d;width:30px}.lamp-base-down:after{height:0!important}.lamp-base:after{background-color:#fff;border-radius:1px 1px 0 0;content:"";height:6px;left:4px;position:absolute;top:-2px;-webkit-transform:translateZ(-1px);transform:translateZ(-1px);width:6px}.lamp-neck{bottom:5px;right:8px;-webkit-transform:translateZ(-1px) rotate(20deg);transform:translateZ(-1px) rotate(20deg)}.lamp-neck,.lamp-neck:after{background-color:var(--lamp-color);height:20px;position:absolute;width:4px}.lamp-neck:after{content:"";left:-8px;top:-14px;-webkit-transform:rotate(-60deg);transform:rotate(-60deg)}.lamp-head{--lamp-color-light:hsl(0deg 0% calc(var(--lamp-lightness) - 5%));background-image:linear-gradient(to bottom,var(--lamp-color-light) 5%,var(--lamp-color) 90%,var(--lamp-color-light) 5%);border-radius:100px 100px 0 0;box-shadow:0 4px 4px -2px #e6e6e6;height:10px;left:10px;position:absolute;top:4px;-webkit-transform:rotate(45deg);transform:rotate(45deg);-webkit-transform-style:preserve-3d;transform-style:preserve-3d;width:20px}.lamp-head:before{background-color:var(--lamp-color);border-radius:50%;display:block;height:6px;right:6px;top:-4px;width:6px px}.lamp-head:after,.lamp-head:before{content:"";position:absolute;-webkit-transform:translateZ(-1px);transform:translateZ(-1px)}.lamp-head:after{background:var(--lamp-head-background);-webkit-clip-path:polygon(30% 0,70% 0,100% 100%,0 100%);clip-path:polygon(30% 0,70% 0,100% 100%,0 100%);height:40px;right:0;top:10px;width:20px}:root{--deckgo-highlight-code-font-family:source-code-pro,Menlo,Monaco,Consolas,Courier New,monospace}html[data-theme=dark]{--blue:#02bbff;--background-color:#141414;--background-color-transparent:rgba(0,0,0,.9);--font-color:#dedede;--font-color-header:#fff;--font-color-highlight:#efefef;--btn-color:#333;--card-background-color:#222;--quote-background-color:#242424;--font-color-quote:#bdcbdc;--card-background-border-color:#2a2a2a;--card-box-shadow:#333;--code-font-color:#c678dd;--code-background-color:rgba(0,0,0,.1);--code-border-color:rgba(0,0,0,.02);--code-block-background:#1c1c1c;--navigator-hover-color:hsla(0,0%,100%,.1);--navigator-border-color:#222;--table-border-color:#303030;--lamp-head-background:transparent}html[data-theme=light]{--blue:#02bbff;--background-color:#fff;--background-color-transparent:hsla(0,0%,100%,.9);--font-color:#000;--font-color-header:#3c4043;--btn-color:#fff;--card-background-color:#efefef;--card-background-border-color:#efefef;--quote-background-color:#eaf8ff;--font-color-highlight:#000;--font-color-quote:#555;--card-box-shadow:rgba(0,0,0,.1);--code-font-color:#444;--code-background-color:rgba(255,229,100,.2);--code-border-color:rgba(255,229,100,.2);--code-block-background:#313131;--navigator-hover-color:rgba(0,0,0,.08);--navigator-border-color:#ddd;--table-border-color:#ededed;--lamp-head-background:linear-gradient(hsla(0,0%,100%,.8),hsla(0,0%,100%,.35),hsla(0,0%,100%,.05))}html{background-color:#212121;border:none}body{background-color:var(--background-color);color:var(--font-color);font-family:Lato,Georgia,serif}a{color:inherit;text-decoration:none}*{-webkit-tap-highlight-color:rgba(0,0,0,0);border:none;box-sizing:border-box;list-style-type:none;margin:0;padding:0}ol{margin:.7rem 0}ol li{list-style-type:decimal;margin:.6rem 0 .6rem 2rem}p{-webkit-margin-before:1em;-webkit-margin-after:1em;-webkit-margin-start:0;-webkit-margin-end:0;display:block;line-height:1.8;margin-block-end:1em;margin-block-start:1em;margin-bottom:.7rem;margin-inline-end:0;margin-inline-start:0;margin-top:.7rem}::selection{background-color:var(--blue);color:#fff}body{word-wrap:break-word;font-kerning:normal;margin:0;padding:0}header{align-items:center;display:flex;flex-direction:row;justify-content:space-around;padding-bottom:0}header>.route-link{margin:0 1rem}.layout{display:flex;flex-direction:row}.base-wrapper{margin-left:auto;margin-right:auto;max-width:1080px;min-height:100%;min-width:350px;padding:2.625rem 1.3125rem;width:60%}.article-body .article-title{font-size:2.2rem;font-weight:700;margin-bottom:2rem;text-align:center}.article-body strong{color:var(--font-color-highlight)}.article-meta{font-size:.9rem;margin:1rem auto;margin-bottom:3rem!important;text-align:center}.article-meta>span{background-color:var(--card-background-color);border-radius:.5rem;font-weight:lighter;padding:.5rem 1rem}.article-body h1,h2,h3{cursor:pointer}.article-body p{font-size:16px;font-weight:400;margin-bottom:1.2rem;margin-top:1.2rem}.article-body h1{color:var(--font-color-header);font-size:2rem;font-weight:700;margin-bottom:1.8rem;margin-top:3.5rem}.article-body h1 code{font-size:2rem}.article-body h2{color:var(--font-color-header);font-size:1.6rem;font-weight:700;margin-bottom:1rem;margin-top:2.5rem}.article-body h2 code{font-size:1.5rem}.article-body h3{color:var(--font-color-header);font-size:1.3rem;font-weight:700;line-height:1.8;margin-bottom:1rem;margin-top:1.8rem}.article-body h3 code{font-size:1.2rem;font-weight:700}.article-body h4{color:var(--font-color-header);font-weight:500;margin-bottom:1rem;margin-top:1.5rem}.article-body h4 code{font-size:1rem}.article-body h1:first-child{border-radius:.5rem}.article-body h1:not(:first-child):before{margin-bottom:.5rem}.article-body h1:not(:first-child):before,.article-body h2:before{background:var(--blue);content:"";display:block;height:2px;width:70px}.article-body h2:before{margin-bottom:.3rem}.article-body code{background-color:var(--code-background-color);border:1px solid var(--code-border-color);border-radius:4px;color:var(--code-font-color);font-family:Menlo,Monaco,Consolas,monospace;font-size:15px;margin:0 2px;padding:1px 4px}.article-body blockquote{background-color:var(--quote-background-color);border-left:2px solid var(--blue);border-radius:0 .5rem .5rem 0;color:var(--font-color-quote);margin-top:1rem;padding:1rem}.article-body blockquote code{color:var(--code-font-color)}.article-body .article-cover{border-radius:16px;box-shadow:0 0 1px rgba(0,0,0,.1);margin:18px auto 20px;width:80%}.article-body .article-cover,.article-body img{display:block;min-width:330px;-o-object-fit:cover;object-fit:cover}.article-body img{border-radius:12px;margin:18px auto;width:85%}.article-body ul{margin:.7rem 0}.article-body ul li{list-style-type:disc;margin:.6rem 0 .6rem 2rem}.article-body a{color:#189fff}a:hover{text-decoration:underline}.article-body a:after{content:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMSIgaGVpZ2h0PSIxMSIgY2xhc3M9InByZWZpeF9faWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCI+PHBhdGggZmlsbD0iIzE4OWZmZiIgZD0iTTkyNC40MDIgMTAyMy4wNjhILjY4Vjk5LjM0NUg0NjIuNTR2OTguOTFIOTkuNTk3VjkyNC4xNWg3MjUuODk2VjU2MS4yMDdoOTguOTF6Ii8+PHBhdGggZmlsbD0iIzE4OWZmZiIgZD0ibTkzMC44MDUgMjIuOTc3IDY5Ljk2NiA2OS45NjYtNDUzLjQ5MyA0NTMuNDkyLTY5Ljk2NS02OS45MDF6Ii8+PHBhdGggZmlsbD0iIzE4OWZmZiIgZD0iTTEwMjIuNDY0IDMwNC4wM2gtOTguOTE3Vjk5LjM0NUg3MDkuMjMxVi40MjhoMzEzLjIzM3oiLz48L3N2Zz4=);padding-left:2px}.article-body table{word-wrap:normal;border-collapse:collapse;table-layout:fixed;width:100%}th{background-color:rgba(0,0,0,.06);text-align:center}td{background-color:hsla(0,0%,100%,.01);font-weight:300}table,td,th{border:1px solid var(--table-border-color);overflow:auto;padding:.5rem}.theme-changer{border-radius:50%;bottom:1rem;cursor:pointer;position:fixed;right:1rem}.theme-changer img{background-color:var(--background-color);border:1px solid var(--card-background-border-color);border-radius:50%;height:30px;padding:6px;width:30px}.iframe-wrapper{aspect-ratio:16/9;border-radius:8px;height:auto;margin-bottom:.5rem;margin-top:1rem;overflow:hidden;padding:0;position:relative;width:100%}.iframe-wrapper .loader{color:#dcdcdc;font-family:sans-serif;font-size:2.5rem;left:50%;position:absolute;text-align:center;top:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);-webkit-user-select:none;-ms-user-select:none;user-select:none}iframe{aspect-ratio:16/9;height:auto;width:100%}deckgo-highlight-code{background-color:var(--code-block-background);border-radius:.5rem;box-shadow:none!important;cursor:pointer;font-size:14px;margin-top:1rem;position:relative}.not-found-background,deckgo-highlight-code{-webkit-user-select:none;-ms-user-select:none;user-select:none}.not-found-background{aspect-ratio:16/9}.not-found-background h1{background-color:rgba(0,0,0,.8);border-radius:8px;box-shadow:0 0 3rem rgba(0,0,0,.9);color:#ef3939;margin-top:4rem;padding:8px;text-align:center}@media (min-width:900px){deckgo-highlight-code:after{content:"双击复制";font-size:11px;height:2rem;opacity:0;position:absolute;right:1rem;text-align:center;top:1rem;transition:.4s;width:4rem}deckgo-highlight-code:hover:after{opacity:1}}@media (max-width:1100px){.base-wrapper[name=article-wrapper]{margin-left:0;padding-left:0;padding-right:0;width:75%}.base-wrapper{width:80%}.article-body h1,.article-body h2,.article-body h3,.article-body p{padding-left:.8rem;padding-right:.8rem}.article-body li{padding-right:.8rem}.article-body img,.iframe-wrapper,blockquote,deckgo-highlight-code{border-radius:0!important}.article-body img{width:100%}}@media (max-width:750px){.base-wrapper[name=article-wrapper]{padding:2.625rem 0}.base-wrapper,.base-wrapper[name=article-wrapper]{margin-left:auto;margin-right:auto;min-height:100%;width:100%}.base-wrapper{margin-top:64px;padding:2.625rem 1rem}.not-found-background{aspect-ratio:9/20;-webkit-user-select:none;-ms-user-select:none;user-select:none}}.avatar{align-items:center;display:flex;flex-direction:row;height:8rem;justify-content:center}.avatar>img{border-radius:50%;box-shadow:0 0 4px rgba(0,0,0,.1);max-height:100%;-o-object-fit:cover;object-fit:cover;-o-object-position:center center;object-position:center center;opacity:1;padding:.5rem;transition:none 0s ease 0s}.progresser{background-color:var(--background-color);border:1px solid var(--card-background-border-color);border-radius:15px 0 0 15px;bottom:4rem;color:var(--font-color);cursor:pointer;font-family:Courier New,Courier,monospace;font-size:13px;font-weight:lighter;height:30px;line-height:30px;position:fixed;right:0;text-align:center;transition:.2s;-webkit-user-select:none;-ms-user-select:none;user-select:none;width:48px;z-index:9}.progresser:after{background-color:var(--quote-background-color);border-radius:15px 0 0 15px;content:"";opacity:0;transition:.2s}.progresser:after,.progresser:hover:after{bottom:0;left:0;position:absolute;right:0;top:0}.progresser:hover:after{content:"up";opacity:1}.progresser-hide{-webkit-transform:translateX(100%);transform:translateX(100%)}.table-of-content{background-color:var(--background-color);border-left:1px solid var(--card-background-border-color);height:100vh;position:-webkit-sticky;position:sticky;top:0;-webkit-user-select:none;-ms-user-select:none;user-select:none;width:20%}.table-of-content-main{height:100%;overflow-y:auto;padding:2.5rem 1.2rem 3rem}.table-of-content-main::-webkit-scrollbar{width:0}.table-of-content-switch{display:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.table-of-content-visible{-webkit-transform:translateX(0)!important;transform:translateX(0)!important}@media (max-width:1100px){.table-of-content{width:25%}}@media (max-width:750px){.table-of-content{-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);background-color:var(--background-color-transparent);border:none;box-shadow:0 0 8px rgba(0,0,0,.1);height:100%;max-width:400px;padding:0;position:fixed;right:0;-webkit-transform:translateX(100%);transform:translateX(100%);transition:.3s;width:calc(100% - 80px);z-index:11}p.header-level-h1:first-child{padding-left:14px!important;-webkit-transform:translateX(0);transform:translateX(0)}.table-of-content-main{padding:2rem 0}.table-of-content h4{font-size:1.2rem!important;margin-top:1rem!important;padding-left:1rem;padding-right:1rem}.table-of-content p{border-bottom:1px solid var(--navigator-border-color);font-size:1rem!important;line-height:2.8rem!important;margin-top:0!important;padding-right:2rem!important;transition:background .3s}.table-of-content p.header-level-h1{font-weight:700;margin-top:.8rem;padding-left:2rem}.table-of-content p.header-level-h2{font-size:15px;margin-top:.4rem;padding-left:3rem}.table-of-content .header-level-h3{font-size:15px;margin-top:.2rem;padding-left:4rem}.table-of-content p:hover{background:var(--navigator-hover-color)}.table-of-content-switch{background-color:blue;background-color:var(--background-color);border:1px solid var(--card-background-border-color);border-radius:50%;color:var(--font-color);cursor:pointer;display:block;font-size:.8rem;height:30px;line-height:30px;position:fixed;right:.5rem;text-align:center;top:4.5rem;width:30px;z-index:8}}.table-of-content::-webkit-scrollbar{display:none}.table-of-content p{cursor:pointer;margin:0;overflow-x:hidden;text-overflow:ellipsis;white-space:nowrap;width:100%}.table-of-content .topHeader{color:var(--blue)!important}.table-of-content p:hover{color:var(--blue)}p.header-level-h1:first-child{border-left:2px solid var(--blue);padding-left:4px;-webkit-transform:translateX(-8px);transform:translateX(-8px)}p.header-level-h1{font-size:15px;font-weight:700;margin-top:.8rem}p.header-level-h2{font-size:14px;margin-top:.4rem;padding-left:1rem}p.header-level-h3{font-size:14px;margin-top:.2rem;padding-left:2rem}</style><meta name="generator" content="Gatsby 4.4.0"/><link rel="icon" href="/favicon-32x32.png?v=d58da36a3a1345ad1c6bcba6e7d0c6de" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="use-credentials"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=d58da36a3a1345ad1c6bcba6e7d0c6de"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=d58da36a3a1345ad1c6bcba6e7d0c6de"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=d58da36a3a1345ad1c6bcba6e7d0c6de"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=d58da36a3a1345ad1c6bcba6e7d0c6de"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=d58da36a3a1345ad1c6bcba6e7d0c6de"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=d58da36a3a1345ad1c6bcba6e7d0c6de"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=d58da36a3a1345ad1c6bcba6e7d0c6de"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=d58da36a3a1345ad1c6bcba6e7d0c6de"/><link as="script" rel="preload" href="/webpack-runtime-be4e6448a97e15bbfe34.js"/><link as="script" rel="preload" href="/framework-f27b074ecebec0f1dbc4.js"/><link as="script" rel="preload" href="/app-9219071c395ef3fffffa.js"/><link as="script" rel="preload" href="/cb1608f2-11f3b27bb6d43c4002d7.js"/><link as="script" rel="preload" href="/a9a7754c-d1e0ec91a76ed49794d7.js"/><link as="script" rel="preload" href="/commons-8aa8ea61781968697067.js"/><link as="script" rel="preload" href="/component---src-pages-articles-mdx-slug-js-7c025e8ce7d57a030f06.js"/><link as="fetch" rel="preload" href="/page-data/articles/redbook-series/redbook-chapter06/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/2757060725.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/3605573801.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><title>Louis K - Software Engineer</title><header class="navbar"><nav><div class="nav-link"><img alt="avatar" src="/static/avatar-05f3b9b1e1ce151053fb8a66dbc70489.png"/><span class="img-label">Louis K</span></div><a class="nav-link" href="/"><span class="link-label">Tech</span></a><a class="nav-link" href="/nonTech/"><span class="link-label">Ramble</span></a><div class="nav-link"><button class="lamp" aria-pressed="true" type="button"><span class="lamp-base"></span><span class="lamp-neck"></span><span class="lamp-head"></span></button></div></nav></header><main class="layout"><div class="article-navigator-switch"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="list" class="svg-inline--fa fa-list " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M88 48C101.3 48 112 58.75 112 72V120C112 133.3 101.3 144 88 144H40C26.75 144 16 133.3 16 120V72C16 58.75 26.75 48 40 48H88zM480 64C497.7 64 512 78.33 512 96C512 113.7 497.7 128 480 128H192C174.3 128 160 113.7 160 96C160 78.33 174.3 64 192 64H480zM480 224C497.7 224 512 238.3 512 256C512 273.7 497.7 288 480 288H192C174.3 288 160 273.7 160 256C160 238.3 174.3 224 192 224H480zM480 384C497.7 384 512 398.3 512 416C512 433.7 497.7 448 480 448H192C174.3 448 160 433.7 160 416C160 398.3 174.3 384 192 384H480zM16 232C16 218.7 26.75 208 40 208H88C101.3 208 112 218.7 112 232V280C112 293.3 101.3 304 88 304H40C26.75 304 16 293.3 16 280V232zM88 368C101.3 368 112 378.7 112 392V440C112 453.3 101.3 464 88 464H40C26.75 464 16 453.3 16 440V392C16 378.7 26.75 368 40 368H88z"></path></svg></div><div class="article-navigator"><h4>electron</h4><p title="electron中的进程模型" class="">electron中的进程模型</p><h4>前端杂谈</h4><p title="“关于Unicode和字符集，你至少应该了解这些”" class="">“关于Unicode和字符集，你至少应该了解这些”</p><p title="跨源资源共享（CORS）" class="">跨源资源共享（CORS）</p><p title="V8引擎中的对象属性访问" class="">V8引擎中的对象属性访问</p><p title="关于no-cors的误区" class="">关于no-cors的误区</p><p title="地图工具中的线条吸附——一个简单方案" class="">地图工具中的线条吸附——一个简单方案</p><p title="渲染页面：浏览器的工作原理" class="">渲染页面：浏览器的工作原理</p><p title="React diffing算法" class="">React diffing算法</p><p title="Vercel简介 静态博客部署" class="">Vercel简介 静态博客部署</p><h4>JavaScript数据结构和算法</h4><p title="（八）字典和散列表" class="">（八）字典和散列表</p><p title="（十）树" class="">（十）树</p><p title="（十四）算法设计与技巧" class="">（十四）算法设计与技巧</p><h4>JavaScript高级程序设计</h4><p title="（一）什么是JavaScript？" class="">（一）什么是JavaScript？</p><p title="（二）HTML中的JavaScript" class="">（二）HTML中的JavaScript</p><p title="（三）JavaScript语言基础" class="">（三）JavaScript语言基础</p><p title="（四）变量、作用域与内存" class="">（四）变量、作用域与内存</p><p title="（五）基本引用类型" class="">（五）基本引用类型</p><p title="（六）集合引用类型" class="highlighted-navigator-item">（六）集合引用类型</p><p title="（七）迭代器与生成器" class="">（七）迭代器与生成器</p><p title="（十一）期约与异步函数" class="">（十一）期约与异步函数</p><p title="（十四）DOM" class="">（十四）DOM</p><p title="（十五）DOM扩展" class="">（十五）DOM扩展</p><p title="（十七）事件" class="">（十七）事件</p><p title="（二十）JavaScript API" class="">（二十）JavaScript API</p><p title="（二十三）JSON" class="">（二十三）JSON</p><p title="（二十四）网络请求与远程资源" class="">（二十四）网络请求与远程资源</p><p title="（二十五）客户端存储" class="">（二十五）客户端存储</p><p title="（二十六）模块" class="">（二十六）模块</p></div><main class="base-wrapper" name="article-wrapper"><main><div class="progresser">0<!-- -->%</div><article class="article-body" style="margin-bottom:4rem"><h1 class="article-title">（六）集合引用类型</h1><p class="article-meta"><span><span role="img" aria-label="field-time" class="anticon anticon-field-time"><svg viewBox="64 64 896 896" focusable="false" data-icon="field-time" width="1em" height="1em" fill="currentColor" aria-hidden="true"><defs><style></style></defs><path d="M945 412H689c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h256c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zM811 548H689c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h122c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zM477.3 322.5H434c-6.2 0-11.2 5-11.2 11.2v248c0 3.6 1.7 6.9 4.6 9l148.9 108.6c5 3.6 12 2.6 15.6-2.4l25.7-35.1v-.1c3.6-5 2.5-12-2.5-15.6l-126.7-91.6V333.7c.1-6.2-5-11.2-11.1-11.2z"></path><path d="M804.8 673.9H747c-5.6 0-10.9 2.9-13.9 7.7a321 321 0 01-44.5 55.7 317.17 317.17 0 01-101.3 68.3c-39.3 16.6-81 25-124 25-43.1 0-84.8-8.4-124-25-37.9-16-72-39-101.3-68.3s-52.3-63.4-68.3-101.3c-16.6-39.2-25-80.9-25-124 0-43.1 8.4-84.7 25-124 16-37.9 39-72 68.3-101.3 29.3-29.3 63.4-52.3 101.3-68.3 39.2-16.6 81-25 124-25 43.1 0 84.8 8.4 124 25 37.9 16 72 39 101.3 68.3a321 321 0 0144.5 55.7c3 4.8 8.3 7.7 13.9 7.7h57.8c6.9 0 11.3-7.2 8.2-13.3-65.2-129.7-197.4-214-345-215.7-216.1-2.7-395.6 174.2-396 390.1C71.6 727.5 246.9 903 463.2 903c149.5 0 283.9-84.6 349.8-215.8a9.18 9.18 0 00-8.2-13.3z"></path></svg></span> <!-- -->2022-01-17<!-- --> | <span role="img" aria-label="read" class="anticon anticon-read"><svg viewBox="64 64 896 896" focusable="false" data-icon="read" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M928 161H699.2c-49.1 0-97.1 14.1-138.4 40.7L512 233l-48.8-31.3A255.2 255.2 0 00324.8 161H96c-17.7 0-32 14.3-32 32v568c0 17.7 14.3 32 32 32h228.8c49.1 0 97.1 14.1 138.4 40.7l44.4 28.6c1.3.8 2.8 1.3 4.3 1.3s3-.4 4.3-1.3l44.4-28.6C602 807.1 650.1 793 699.2 793H928c17.7 0 32-14.3 32-32V193c0-17.7-14.3-32-32-32zM324.8 721H136V233h188.8c35.4 0 69.8 10.1 99.5 29.2l48.8 31.3 6.9 4.5v462c-47.6-25.6-100.8-39-155.2-39zm563.2 0H699.2c-54.4 0-107.6 13.4-155.2 39V298l6.9-4.5 48.8-31.3c29.7-19.1 64.1-29.2 99.5-29.2H888v488zM396.9 361H211.1c-3.9 0-7.1 3.4-7.1 7.5v45c0 4.1 3.2 7.5 7.1 7.5h185.7c3.9 0 7.1-3.4 7.1-7.5v-45c.1-4.1-3.1-7.5-7-7.5zm223.1 7.5v45c0 4.1 3.2 7.5 7.1 7.5h185.7c3.9 0 7.1-3.4 7.1-7.5v-45c0-4.1-3.2-7.5-7.1-7.5H627.1c-3.9 0-7.1 3.4-7.1 7.5zM396.9 501H211.1c-3.9 0-7.1 3.4-7.1 7.5v45c0 4.1 3.2 7.5 7.1 7.5h185.7c3.9 0 7.1-3.4 7.1-7.5v-45c.1-4.1-3.1-7.5-7-7.5zm416 0H627.1c-3.9 0-7.1 3.4-7.1 7.5v45c0 4.1 3.2 7.5 7.1 7.5h185.7c3.9 0 7.1-3.4 7.1-7.5v-45c.1-4.1-3.1-7.5-7-7.5z"></path></svg></span> <!-- -->3100<!-- -->words <!-- -->11<!-- -->min</span></p><h1>Object</h1><p>在 ECMAScript 中，最多使用的引用类型是<code>Object</code>类型，其实例不具备多少有用的方法，但是很适合用来存储和交换数据，常用的 JSON 数据结构就是指 JavaScript 对象标记。一般来说很少使用<code>new</code>操作符和<code>Object</code>构造函数来直接实例化<code>Object</code>，而更多使用<strong>对象字面量</strong>表示法。
对象字面量是对象定义的简写形式，目的是为了简化包含大量属性的对象创建。</p><deckgo-highlight-code language="javascript" theme="one-dark">
          <code slot="code">// new操作实例化
const person = new Object()
person.name = &#x27;Louis K&#x27;
person.age = 25

// 对象字面量
const person = {
  name: &#x27;Peter&#x27;,
  age: 20,
}</code>
        </deckgo-highlight-code><p><code>{</code>出现在表达式上下文中表示对象字面的开始，表达式上下文是指期待返回值的上下文；它出现在语句上下文中时，表示一个语句块的开始。</p><p>在对象字面量表示法中，所有创建的对象都是无序的键值对。数值属性也会自动转换为字符串：</p><deckgo-highlight-code language="javascript" theme="one-dark">
          <code slot="code">const person = {
  name: &#x27;Louis K&#x27;,
  age: 25,
  5: [&#x27;1&#x27;, &#x27;2&#x27;],
}

function createPerson({ name, age, gender, height, weight }) {
  // ...
}</code>
        </deckgo-highlight-code><p>对象字面量也是给函数传递大量可选参数的主要方式。</p><blockquote><p>在使用对象字面表示法定义对象时，并不会实际调用<code>Object</code>构造函数。</p></blockquote><h1>Array</h1><p><code>Array</code>是 ECMAScript 中最常用的数据类型之一。ECMAScript 的数组本质上也是一个对象，它并不限制元素的类型，可以存储任意类型的数据，并且它的大小也是动态的。</p><p>创建数组可以使用<code>Array</code>构造函数，是否使用<code>new</code>操作符返回的结果是相同的。</p><deckgo-highlight-code language="javascript" theme="one-dark">
          <code slot="code">const arr1 = new Array()
const arr2 = Array()</code>
        </deckgo-highlight-code><p>和对象一样，可以通过字面量表示法来创建数组，同样地，在使用数组字面量表示法创建数组时不会调用<code>Array</code>构造函数。<code>Array</code>构造函数还提供了两个 ES6 新增的静态方法来创建数组，<code>Array.from()</code>和<code>Array.of()</code>。前者用来将类数组结构（即任何可迭代对象）转换成数组实例，后者用来将一组参数转换为数组实例。</p><blockquote><p><code>Array.from()</code>方法可以接受第二个映射函数参数，可以直接将可迭代对象映射为新数组。<code>Array.from([1, 2, 3], x =&gt; x ** 2)</code></p></blockquote><p>注意，数组字面量定义时最好避免数组空位的写法，类似：</p><deckgo-highlight-code language="javascript" theme="one-dark">
          <code slot="code">const arr = [&#x27;a&#x27;, &#x27;b&#x27;, , , &#x27;c&#x27;]
// 最好显示使用undefined
const arr = [&#x27;a&#x27;, &#x27;b&#x27;, undefined, undefined, &#x27;c&#x27;]</code>
        </deckgo-highlight-code><p>ECMAScript 数组同样可以通过索引来读取和写入值。使用中括号语法可以使用索引，如果把一个值设置给超过数组最大索引的索引，那么数组的长度就会自动扩展到该索引值加 1。此外，数组的<code>length</code>属性，用来返回数组的长度。但是它不是一个只读的属性，通过设置这个属性，ECMAScript 数组的大小会改变，从而从数组末尾添加或者删除元素。注意在实际开发中不建议使用这种方法来改变数组的长度，应该将<code>length</code>作为一个只读属性来使用。</p><blockquote><p>ECMAScript 数组的最大长度是 4294_967_295 个元素（<code>2 ** 32 - 1</code>)。</p></blockquote><p>判断一个对象是否是数组的方法可以是<code>instanceof</code>操作符，但是它有一个问题，那就是依赖于一个全局执行上下文。如果网页存在多个全局执行上下文，因此会有两个不同版本的<code>Array</code>构造函数，因此有可能产生错误。为了解决这个问题，ECMAScript 推出一个可靠的判断数组的方法，那就是<code>Array.isArray()</code>方法，它可以确定一个对象是否是数组而不对全局执行上下文作出假设。</p><p>迭代一个 ECMAScript 数组可以使用 for-of 循环或者普通 for 循环。在 ES6 中，<code>Array</code>的原型暴露了 3 个用于检索数组内容的方法：<code>keys()</code>，<code>values()</code>，<code>entries()</code>。使用 ES6 的数组解构语法，可以非常容易地在循环中拆分键/值对：</p><deckgo-highlight-code language="javascript" theme="one-dark">
          <code slot="code">const arr = [&#x27;some&#x27;, &#x27;string&#x27;, &#x27;I&#x27;, &#x27;want&#x27;, &#x27;to&#x27;, &#x27;use&#x27;]

for (const [idx, element] of arr.entries()) {
  alert(idx)
  alert(element)
}</code>
        </deckgo-highlight-code><p>值得一提的是，ES6 还为数组添加了<code>Array.prototype.copyWithin</code>方法和<code>Array.prototype.fill</code>方法。在指定了数组实例上的一个范围索引（包含开始，不包含结束），进行数组填充或者浅拷贝。</p><p>ECMAScript 给数组定义了几个方法来使得数组可以实现栈和队列。主要是<code>pop()</code>，<code>shift()</code>，<code>push()</code>和<code>unshift()</code>方法。</p><p>ECMAScript 数组提供了两个方法来对自身包含的元素进行重新排序：<code>reverse()</code>和<code>sort()</code>，故名思义，<code>reverse()</code>就是将数组按照当前排序的相反数序排列。而<code>sort()</code>方法接受一个比较函数，如果前一个值需要排在后面，那么比较函数返回正数。</p><p>数组的搜索和位置方法分为两种：严格相等和断言函数。前者包括使用<code>indexOf()</code>，<code>lastIndexOf()</code>，<code>includes()</code>；后者包括<code>find()</code>，<code>findIndex()</code>，接受一个断言函数来判读元素是否匹配条件。</p><p>ECMAScript 数组定义了 5 个常用的迭代方法。每个方法都接受一个以每一项为参数运行的函数。</p><ul><li><code>every()</code>：对数组的每一项都运行传入的函数，如果对每一项都返回<code>true</code>，则方法返回<code>true</code>否则<code>false</code>。</li><li><code>filter()</code>：对数组的每一项都运行传入的函数，函数返回<code>true</code>的项组成的数组之后返回。</li><li><code>forEach()</code>：对数组每一项都运行传入的函数，没有返回值。</li><li><code>map()</code>：对数组的每一项都运行传入的函数，返回由每次调用的结果组成的数组。</li><li><code>some()</code>：对数组的每一项都运行传入的函数，如果有一项函数返回<code>true</code>，则这个方法返回<code>true</code>。</li></ul><p>最后，ECMAScript 数组还定义了两个归并方法：<code>reduce()</code>和<code>reduceRight()</code>。这两个方法都会迭代数组的所有项，并在此基础上构建一个最终返回值。
<code>reduce()</code>方法从数组的第一项开始遍历到最后一项，而<code>reduceRight()</code>方法从最后一项开始遍历到第一项。</p><h1>定型数组</h1><p>定型数组（typed array）是 ES6 新增的数据结构，目的是提升向原生库传输数据的效率。实际上 ECMAScript 并没有 TypedArray 类型，定型数组是指一种包含特定数值类型的数组。</p><p>随着浏览器的流行，人们期待它可以用来运行复杂的 3D 应用程序。早在 2006 年，部分厂商就实验性地在浏览器中增加了用于渲染复杂图形应用程序的编程平台而无需安装任何插件。其目标是开发一套 JavaScript API，从而充分利用 3D 图形 API 和 GPU 加速，以便在<code>&lt;canvas&gt;</code>元素上渲染复杂的图形。</p><blockquote><p><strong>WebGL</strong>: 最后的 JavaScript API 是基于 OpenGL ES（OpenGL for Embedded Systems）2.0 规范的。OpenGL ES 是 OpenGL 专注于 2D 和 3D 计算机图形的子集。这个新 API 被命名为 WebGL（Web Graphics Library），于 2011 年发布了 1.0 版本。有了它，Web 开发者可以编写涉及复杂图形的应用程序，它会被兼容 WebGL 的浏览器原生解释执行。</p><p>在 WebGL 早期版本中，因为 JavaScript 数组与原生数组之间不匹配，所以出现了性能问题。图形驱动程序 API 通常不需要以 JavaScript 默认双精度浮点格式传递给它们的数值，而这恰好是 JavaScript 数组在内存中的格式。因此每次 WebGL 和 JavaScript 运行时之间传递数组时，WebGL 绑定都需要在目标环境分配新数组，以其当前格式迭代数组，然后将数值转型为新数组中的适当格式，而这些要花费很多时间。</p></blockquote><p>由于数组和原生数组的不匹配问题导致的时间浪费是难以接受的，Mozilla 为解决这个问题而实现了<code>CanvasFloatArray</code>。这是一个提供了 JavaScript 接口的、C 语言风格的浮点值数组。JavaScript 运行时使用这个类型可以分配、读取和写入数组。这个数组可以直接传给底层图形驱动程序 API，也可以直接从底层获取到。最终<code>CanvasFloatArray</code>变成了<code>Float32Array</code>，也就是今天定型数组中可用的第一个“类型”。</p><h2>ArrayBuffer</h2><p><code>Float32Array</code>实际上是一种“视图”，可以允许 JavaScript 运行时访问一块名为<code>ArrayBuffer</code>的预分配内存。<code>ArrayBuffer</code>是所有定型数组及视图引用的基本单位。</p><blockquote><p><code>SharedArrayBuffer</code>是<code>ArrayBuffer</code>的一个变体，可以无需复制就在执行上下文间传递它。</p></blockquote><p><code>ArrayBuffer</code>是一个普通的 JavaScript 构造函数，可以用于在内存中分配特定数量的字节空间。</p><deckgo-highlight-code language="javascript" theme="one-dark">
          <code slot="code">const buf = new ArrayBuffer(16) // 在内存中分配16字节
alert(buf.byteLength)</code>
        </deckgo-highlight-code><p><code>ArrayBuffer</code>一经创建就不能再调整大小。不过可以使用<code>slice()</code>方法将其全部或者部分复制到一个新的实例中：</p><deckgo-highlight-code language="javascript" theme="one-dark">
          <code slot="code">const buf1 = new ArrayBuffer(16)
const buf2 = buf1.slice(4, 12)
alert(buf2.byteLength)</code>
        </deckgo-highlight-code><p>不能仅通过 <code>ArrayBuffer</code>的引用就读取或写入其内容。要读取或写入<code>ArrayBuffer</code>，就必须通过视图。视图有不同的类型，但引用的都是<code>ArrayBuffer</code>中存储的二进制数据。</p><h2>DataView</h2><p>第一种允许读写<code>ArrayBuffer</code>的视图是<code>DataView</code>。这个视图专门为文件 I/O 和网络 I/O 设计，其 API 支持对缓冲数据的高度控制，但相比于其他类型的视图性能也更差些。<code>DataView</code>对缓冲内容没有任何假设，并且也<strong>不能迭代</strong>。</p><p>必须在已有的<code>ArrayBuffer</code>读取或写入时才能创建<code>DataView</code>实例。这个实例可以使用全部或者部分的<code>ArrayBuffer</code>，且维护着对该缓冲实例的引用，以及视图在缓冲中开始的位置。</p><deckgo-highlight-code language="javascript" theme="one-dark">
          <code slot="code">const buf = new ArrayBuffer(16)

// DataView默认使用整个ArrayBuffer
const fullDataView = new DataView(buf)
alert(fullDataView.byteOffset) // 0
alert(fullDataView.byteLength) // 16
alert(fullDataView.buffer === buf) // true

// 构造函数接受一个可选的字节偏移量和字节长度
// byteOffset表示视图从缓冲区的某个起点开始
// byteLength表示视图限制为前多少个字节
const firstHalfDataView = new DataView(buf, 0, 8)
alert(firstHalfDataView.byteOffset) // 0
alert(firstHalfDataView.byteLength) // 8
alert(firstHalfDataView.buffer === buf) // true

// 如果不制定byteLength，那么DataView会使用剩余的缓冲
const secondHalfDataView = new DataView(buf, 8)
alert(secondHalfDataView.byteOffset) // 8
alert(secondHalfDataView.byteLength) // 8
alert(secondHalfDataView.buffer === buf) // true</code>
        </deckgo-highlight-code><p>要通过<code>DataView</code>读取缓冲，还需要几个组件：</p><ul><li>首先是要读/写的字节偏移量，可以看作是<code>DataView</code>中的某种“地址”。</li><li><code>DataView</code>应该使用<code>ElementType</code>来实现 JavaScript 的 Number 类型到缓冲内二进制格式的转换。</li><li>最后是内存中的字节序。默认是大端字节序。</li></ul><blockquote><p><code>ElementType</code>对存储在缓冲区内的数据类型没有假设。它暴露的 API 强制开发者在读/写时指定一个<code>ElementType</code>，然后<code>DataView</code>会为读写完成相应的转换。ES6 支持 8 种不同的<code>ElementType</code>：Int8（8 位有符号整数，<code>signed char</code>）、Uint8（8 位无符号整数，<code>unsigned char</code>）、Int16（16 位有符号整数，<code>short</code>）、Uint16（16 位无符号整数，<code>unsigned shrot</code>）、Int32（32 位有符号整数，<code>int</code>）、Uint32（32 位无符号整数，<code>unsigned int</code>）、Float32（32 位 IEEE-754 浮点数，<code>float</code>）、Float64（64 位 IEEE-754 浮点数，<code>double</code>）。</p></blockquote><p><code>DataView</code>为每一种类型都暴露了<code>get</code>和<code>set</code>方法，这些方法使用<code>byteOffset</code>（字节偏移量）定位要读取或写入值的位置。类型是可以互换使用的。</p><h2>定型数组</h2><p>定型数组是另一种形式的<code>ArrayBuffer</code>视图。虽然概念上和<code>DataView</code>接近，但定型数组的区别在于，它特定于一种<code>ElementType</code>并且遵循原生的字节序。相应地，定型数组提供了适用面更广的 API 和更高的性能。设计定型数组的目的就是提高与 WebGL 等原生库交换二进制数据的效率。由于定型数组的二进制表示对操作系统而言是一种容易使用的格式，JavaScript 引擎可以重度优化算术运算和其他对定型数组的常见操作，因此使用它们速度极快。</p><p>创建定型数组的方式包括读取已有的缓冲、使用自有缓冲、填充可迭代结构，以及填充基于任意类型的定型数组。另外通过<code>&lt;ElementType&gt;.from()</code>和<code>&lt;ElementType&gt;.of()</code>也可以创建定型数组。</p><deckgo-highlight-code language="javascript" theme="one-dark">
          <code slot="code">const buf = new ArrayBuffer(12) // 12字节的缓冲区

const ints = new Int32Array(buf)
alert(ints.length) // 这个定型数组知道自己的每个元素需要4字节，因此长度为3

const ints2 = new Int32Array(6) // 创建一个长度为6的Int32Array定型数组
alert(ints2.buffer.byteLength) // 类似DataView，定型数组也有一个指向关联缓冲区的引用

const ints3 = new Int32Array([2, 4, 6, 8]) // 创建一个包含了2、4、6、8的Int32Array
alert(ints3.length) // 4
alert(ints3.buffer.byteLength) // 16
alert(ints3[2]) // 6

const ints4 = new Int16Array(ints3) // 通过复制ints3的值创建一个Int16Array，这个新数组会分配自己的缓冲区，对应索引的每个值会转换成对应的格式
alert(ints4.length) // 4
alert(ints4.buffer.byteLength) // 8
alert(ints4[2]) // 6

const ints5 = Int16Array.from([3, 5, 7, 9]) // 基于普通数组来创建一个Int16Array
alert(ints5.length) // 4
alert(ints5.buffer.byteLength) // 8
alert(ints5[2]) // 7

const floats = Float32Array.of(3.14, 2.718, 1.618) // 基于传入的参数创建一个Float32Array
alert(floats.length) // 3
alert(floats.buffer.byteLength) // 12
alert(floats[2]) // 1.61800000305175781</code>
        </deckgo-highlight-code><p>定型数组的构造函数和实例都有一个<code>BYTE_PER_ELEMENT</code>属性，返回该类型数组中的每个元素的大小。</p><h1>Map</h1><p>ES6 之前，在 JavaScript 中实现键/值对式存储可以使用<code>Object</code>实例高效完成，也就是使用对象属性作为键，属性作为值。但是这种实现并非没有问题，为此 TC39 委员会专门为“键/值”对存储定义了一个规范。</p><p>作为 ES6 的新增特性，<code>Map</code>是一种功能新的集合类型，为这门语言带来了真正的键/值存储机制。<code>Map</code>的大多数特性都可以通过<code>Object</code>类型实现，但是二者之间存在些许差异，使用时需要仔细选择。</p><h2>基本 API</h2><p>使用<code>new</code>关键字和<code>Map</code>构造函数可以创建一个空映射：</p><deckgo-highlight-code language="javascript" theme="one-dark">
          <code slot="code">const m = new Map()</code>
        </deckgo-highlight-code><p>初始化时可以给<code>Map</code>构造函数传入一个可迭代对象，需要包含键/值对数组。可迭代对象中的每个键/值对都会按照顺序插入到新映射中：</p><deckgo-highlight-code language="javascript" theme="one-dark">
          <code slot="code">const m1 = new Map([
  [&#x27;key1&#x27;, &#x27;val1&#x27;],
  [&#x27;key2&#x27;, &#x27;val2&#x27;],
  [&#x27;key3&#x27;, &#x27;val3&#x27;],
])</code>
        </deckgo-highlight-code><p>初始化后可以通过<code>set()</code>方法添加键/值对。另外，可以使用<code>get()</code>和<code>has()</code>进行查询，可以通过<code>size</code>属性来获取映射中键/值对的数量，还可以使用<code>clear()</code>和<code>delete()</code>来删除值。</p><p>与<code>Object</code>只能用数值、字符串或者<code>Symbol</code>作为键不同，<code>Map</code>可以使用任何 ECMAScript 数据类型作为键。<code>Map</code>内部使用 SameValueZero 比较操作（ECMAScript 内部定义，语言中不能使用），基本上相当于使用严格对象相等的标准来检查键的匹配性。与<code>Object</code>类似，键的值没有限制。</p><h2>顺序与迭代</h2><p>和<code>Object</code>的一个主要差异是<code>Map</code>实例会维护键值对的插入顺序，因此可以根据插入顺序执行迭代操作。映射实例可以提供一个迭代器(Iterator)，能以插入顺序生成<code>[key, value]</code>形式的数组。可以通过<code>entries()</code>方法取得这个迭代器：</p><deckgo-highlight-code language="javascript" theme="one-dark">
          <code slot="code">const m = new Map([
  [&#x27;key1&#x27;, &#x27;val1&#x27;],
  [&#x27;key2&#x27;, &#x27;val2&#x27;],
  [&#x27;key3&#x27;, &#x27;val3&#x27;],
])

alert(m.entries === m[Symbol.Iterator]) // true

for (let pair of m.entries()) {
  const [key, value] = pair
  // ...
}

m.forEach((val, key) =&gt; alert(key, val)) // 注意在forEach传入函数中第一个参数获取的是值，第二个才是键</code>
        </deckgo-highlight-code><p>另外<code>keys()</code>和<code>values()</code>分别返回以插入顺序生成键和值的迭代器。</p><p>对于多数 Web 开发任务来说，选择哪一个只是个人喜好问题。不过多数时候<code>Map</code>的性能和内存占用表现更好，尤其是删除性能。</p><h1>WeakMap</h1><p>ES6 新增的<code>WeakMap</code>（弱映射）是一种新集合类型，为这门语言带来了增强的键/值对存储机制。<code>WeakMap</code>是<code>Map</code>的兄弟类型，其 API 也是<code>Map</code>的子集。<code>WeakMap</code>的“弱”是指 JavaScript 垃圾回收程序对待“弱映射”中键的方式。</p><h2>基本 API</h2><p>可以使用<code>new</code>关键字实例化一个空的<code>WeakMap</code>：</p><deckgo-highlight-code language="javascript" theme="one-dark">
          <code slot="code">const wm = new WeakMap()</code>
        </deckgo-highlight-code><p>弱映射中的键只能是<code>Object</code>或者继承自<code>Object</code>的类型，尝试使用非对象设置键会抛出<code>TypeError</code>。值的类型没有限制。</p><h2>弱键</h2><p><code>WeakMap</code>中“weak”表示弱映射的键是“弱弱地拿着”的。意思是，这些键不属于正式的引用，不会阻止垃圾回收。但是弱映射的值不是“弱弱地拿着”的，只要键存在，键/值对就会存在于映射中，并被当作对值的引用，因此就不会被当作垃圾回收。</p><p>来看下面的例子：</p><deckgo-highlight-code language="javascript" theme="one-dark">
          <code slot="code">const wm = new WeakMap()

wm.set({}, &#x27;val&#x27;)</code>
        </deckgo-highlight-code><p><code>set()</code>方法初始化了一个新对象并将它用作一个字符串的键。因为没有指向这个对象的其他引用，所以当这行代码执行完成后，这个对象就会被当作垃圾回收。然后，这个键/值对就会从弱映射中消失了，使其成为一个空映射。此例中值也没有被引用，所以这对键/值被破坏后，值也成为垃圾回收的目标。</p><p><code>WeakMap</code>中的键/值对随时都有可能被销毁，因此不需要提供迭代能力。<code>WeakMap</code> 实例之所以限制只能用对象作为键，是为了保证只有通过键对象的引用才能取得值。如果允许原始值，那就没办法区分初始化时使用的字符串字面量和初始化之后使用的一个相等的字符串了。</p><blockquote><p><strong>使用<code>WeakMap</code></strong> <code>WeakMap</code>的用法并不常见，两个最主要的使用场景是：1）弱映射造就了在 JavaScript 中实现真正私有变量的一种新方式；2）因为 WeakMap 实例不会妨碍垃圾回收，所以非常适合保存 DOM 节点关联元数据。</p></blockquote><h2>保存 DOM 关联元数据</h2><deckgo-highlight-code language="javascript" theme="one-dark">
          <code slot="code">const m = new Map()
const loginButton = document.querySelector(&#x27;#login&#x27;)
// 给这个节点关联一些元数据
m.set(loginButton, { disabled: true })</code>
        </deckgo-highlight-code><p>假设在上面的代码执行后，页面被 JavaScript 改变了，原来的登录按钮从 DOM 树中被删掉了。但由于映射中还保存着按钮的引用，所以对应的 DOM 节点仍然会逗留在内存中，除非明确将其从映射中删除或者等到映射本身被销毁。</p><p>如果这里使用的是弱映射，如以下代码所示，那么当节点从 DOM 树中被删除后，垃圾回收程序就 可以立即释放其内存（前提是对象没有其他引用）：</p><deckgo-highlight-code language="javascript" theme="one-dark">
          <code slot="code">const wm = new WeakMap()
const loginButton = document.querySelector(&#x27;#login&#x27;)
// 给这个节点关联一些元数据
wm.set(loginButton, { disabled: true })</code>
        </deckgo-highlight-code></article><div id="commentBoxScript"></div></main></main><div class="table-of-content"><div class="table-of-content-header"></div><div class="table-of-content-main"></div></div><div class="table-of-content-switch"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="bars" class="svg-inline--fa fa-bars " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"></path></svg></div></main><footer class="footer"><div class="wrapper"><div><h3>Thanks for reading!</h3><p>CopyRight © 2022 Louis K - Present</p></div><div><p style="font-size:1.3rem"><span><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="weixin" class="svg-inline--fa fa-weixin " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentColor" d="M385.2 167.6c6.4 0 12.6 .3 18.8 1.1C387.4 90.3 303.3 32 207.7 32 100.5 32 13 104.8 13 197.4c0 53.4 29.3 97.5 77.9 131.6l-19.3 58.6 68-34.1c24.4 4.8 43.8 9.7 68.2 9.7 6.2 0 12.1-.3 18.3-.8-4-12.9-6.2-26.6-6.2-40.8-.1-84.9 72.9-154 165.3-154zm-104.5-52.9c14.5 0 24.2 9.7 24.2 24.4 0 14.5-9.7 24.2-24.2 24.2-14.8 0-29.3-9.7-29.3-24.2 .1-14.7 14.6-24.4 29.3-24.4zm-136.4 48.6c-14.5 0-29.3-9.7-29.3-24.2 0-14.8 14.8-24.4 29.3-24.4 14.8 0 24.4 9.7 24.4 24.4 0 14.6-9.6 24.2-24.4 24.2zM563 319.4c0-77.9-77.9-141.3-165.4-141.3-92.7 0-165.4 63.4-165.4 141.3S305 460.7 397.6 460.7c19.3 0 38.9-5.1 58.6-9.9l53.4 29.3-14.8-48.6C534 402.1 563 363.2 563 319.4zm-219.1-24.5c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.8 0 24.4 9.7 24.4 19.3 0 10-9.7 19.6-24.4 19.6zm107.1 0c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.5 0 24.4 9.7 24.4 19.3 .1 10-9.9 19.6-24.4 19.6z"></path></svg></span><span><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="qq" class="svg-inline--fa fa-qq " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M433.8 420.4c-11.53 1.393-44.86-52.74-44.86-52.74 0 31.34-16.14 72.25-51.05 101.8 16.84 5.192 54.84 19.17 45.8 34.42-7.316 12.34-125.5 7.881-159.6 4.037-34.12 3.844-152.3 8.306-159.6-4.037-9.045-15.25 28.92-29.21 45.78-34.42-34.92-29.54-51.06-70.44-51.06-101.8 0 0-33.33 54.13-44.86 52.74-5.37-.65-12.42-29.64 9.347-99.7 10.26-33.02 21.1-60.48 40.14-105.8C60.68 98.06 108.1 .006 224 0c113.7 .006 163.2 96.13 160.3 214.1 18.12 45.22 29.91 72.85 40.14 105.8 21.77 70.06 14.72 99.05 9.346 99.7z"></path></svg></span><span><a href="mailto:k1664032884@gmail.com"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="envelope" class="svg-inline--fa fa-envelope " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 352c-16.53 0-33.06-5.422-47.16-16.41L0 173.2V400C0 426.5 21.49 448 48 448h416c26.51 0 48-21.49 48-48V173.2l-208.8 162.5C289.1 346.6 272.5 352 256 352zM16.29 145.3l212.2 165.1c16.19 12.6 38.87 12.6 55.06 0l212.2-165.1C505.1 137.3 512 125 512 112C512 85.49 490.5 64 464 64h-416C21.49 64 0 85.49 0 112C0 125 6.01 137.3 16.29 145.3z"></path></svg></a></span><span><a href="https://github.com/kqhasaki" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="github" class="svg-inline--fa fa-github " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3 .3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5 .3-6.2 2.3zm44.2-1.7c-2.9 .7-4.9 2.6-4.6 4.9 .3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3 .7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3 .3 2.9 2.3 3.9 1.6 1 3.6 .7 4.3-.7 .7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3 .7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3 .7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a></span></p></div></div></footer></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/articles/redbook-series/redbook-chapter06/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-a6a9e8476add1045c345.js"],"app":["/app-9219071c395ef3fffffa.js"],"component---src-pages-404-js":["/component---src-pages-404-js-a57028c9ca9b927c5051.js"],"component---src-pages-about-js":["/component---src-pages-about-js-839d876face1402d4ba3.js"],"component---src-pages-articles-mdx-slug-js":["/component---src-pages-articles-mdx-slug-js-7c025e8ce7d57a030f06.js"],"component---src-pages-index-js":["/component---src-pages-index-js-6af5eadfed50129b939a.js"],"component---src-pages-non-tech-js":["/component---src-pages-non-tech-js-fff71251e6fc458a81be.js"]};/*]]>*/</script><script src="/polyfill-a6a9e8476add1045c345.js" nomodule=""></script><script src="/component---src-pages-articles-mdx-slug-js-7c025e8ce7d57a030f06.js" async=""></script><script src="/commons-8aa8ea61781968697067.js" async=""></script><script src="/a9a7754c-d1e0ec91a76ed49794d7.js" async=""></script><script src="/cb1608f2-11f3b27bb6d43c4002d7.js" async=""></script><script src="/app-9219071c395ef3fffffa.js" async=""></script><script src="/framework-f27b074ecebec0f1dbc4.js" async=""></script><script src="/webpack-runtime-be4e6448a97e15bbfe34.js" async=""></script></body></html>