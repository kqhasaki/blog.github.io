<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><script>
            const cachedTheme = localStorage.getItem('theme');
            if (cachedTheme) {
              document.documentElement.dataset.theme = cachedTheme;
            } else {
              const preferredTheme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
              document.documentElement.dataset.theme = preferredTheme;
            }
            </script><style data-href="/styles.454251d7084ae95f11ab.css" data-identity="gatsby-global-css">.modal-wrapper{align-items:center;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);background:rgba(0,0,0,.6);bottom:0;display:flex;justify-content:center;left:0;position:fixed;right:0;top:0;z-index:999}.modal-content-wrapper::-webkit-scrollbar{width:0}.modal-content{background:var(--background-color);border:1px solid var(--card-background-border-color);border-radius:1rem;max-width:1080px;min-width:600px;padding:1.5rem;position:relative;width:50vw}.modal-content-wrapper{max-height:70vh;min-height:50vh;overflow-y:auto;width:100%}.modal-closer{cursor:pointer;font-size:1.2rem;position:absolute;right:.8rem;top:.8rem}.modal-closer:hover{color:var(--blue)}@media (max-width:900px){.modal-content{min-width:90%;width:90%}}.post-card-img{background-color:var(--background-color);border-radius:12px;bottom:0;box-shadow:0 0 6px rgba(0,0,0,.15);height:200px;left:50%;-o-object-fit:cover;object-fit:cover;position:absolute;-webkit-transform:translate(-50%) rotate(-8deg);transform:translate(-50%) rotate(-8deg);transition:.2s;width:300px}.img-line{height:120px;margin-bottom:2rem;position:relative}.post-card{align-items:center;border:1px solid var(--card-background-border-color);border-radius:1.5rem;cursor:pointer;display:flex;flex-direction:column;justify-content:center;margin:140px auto 0;max-width:45rem;padding:1.5rem 2rem;position:relative;transition:.2s}.post-card:hover{box-shadow:0 0 1rem var(--card-box-shadow)}.post-card:active{box-shadow:0 0 1.5rem var(--blue)}.post-card:hover .post-card-img{-webkit-transform:translate(-50%) rotate(0deg);transform:translate(-50%) rotate(0deg)}.post-card h2:after{background:var(--blue);content:"";display:block;height:2px;margin-left:auto;margin-right:auto;margin-top:10px;width:60px}.post-card-meta{background-color:var(--card-background-color);border:1px solid var(--card-background-border-color);border-radius:.5rem;font-size:.9rem;font-weight:300;margin:1rem 0 0;padding:5px 10px}@media (max-width:500px){.post-card{padding:1.5rem .8rem}}.article-navigator{background-color:var(--background-color);border-right:1px solid var(--card-background-border-color);height:100vh;overflow-y:auto;padding:2.5rem 1.2rem 2.5rem 2rem;position:-webkit-sticky;position:sticky;top:0;-webkit-user-select:none;-ms-user-select:none;user-select:none;width:20%}.article-navigator::-webkit-scrollbar{width:0}.article-navigator-visible{-webkit-transform:translateX(0)!important;transform:translateX(0)!important}@media (max-width:1100px){.article-navigator{-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);background-color:var(--background-color-transparent);border:none;box-shadow:0 0 8px rgba(0,0,0,.1);height:100%;left:0;left:auto!important;max-width:400px;padding:0;position:fixed;-webkit-transform:translateX(-100%);transform:translateX(-100%);transition:.3s;width:calc(100% - 80px);z-index:10}.article-navigator h4{font-size:1.2rem!important;margin-top:1rem!important;padding-left:1rem;padding-right:1rem}.article-navigator p{border-bottom:1px solid var(--navigator-border-color);font-size:1rem!important;line-height:2.8rem!important;padding-left:2rem!important;padding-right:2rem!important;transition:background .3s}.article-navigator p:hover{background:var(--navigator-hover-color)}.article-navigator-switch{visibility:visible!important}}.article-navigator h4{font-size:15px;margin-bottom:.5rem;margin-top:1rem}.article-navigator h4:first-child{margin-top:0}.article-navigator-switch{background-color:var(--background-color);border:1px solid var(--card-background-border-color);border-radius:50%;color:var(--font-color);cursor:pointer;font-size:.8rem;height:30px;left:.5rem;line-height:29px;position:fixed;text-align:center;top:4.5rem;visibility:hidden;width:30px;z-index:9}.article-navigator p{cursor:pointer;font-size:14px;margin:0;overflow-x:hidden;padding-left:.5rem;text-overflow:ellipsis;white-space:nowrap;width:100%}.article-navigator p:hover,.highlighted-navigator-item{color:var(--blue)}.item-list{align-items:center;border-left:3px solid var(--blue);display:flex;flex-direction:column;justify-content:center;margin:0 auto 0 1rem}.item-list .item{margin:0;padding:1rem;position:relative;width:100%}.item:before{background-color:var(--blue);border-radius:50%;content:"";height:.8rem;left:-.5rem;position:absolute;top:2rem;transition:.2s;width:.8rem}.item:hover:before{-webkit-transform:scale(1.2);transform:scale(1.2)}.item-list .item-label{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;font-size:15px;font-weight:400}.item-list .item-content{padding-top:.5rem}.homepage-title{font-weight:700;margin:2rem 0 1rem}.item a{transition:.3s}.item a:hover{color:var(--font-color-highlight)}@media (max-width:750px){.base-wrapper[name=article-wrapper]{padding:2.625rem 0}.base-wrapper,.base-wrapper[name=article-wrapper]{margin-left:auto;margin-right:auto;min-height:100%;width:100%}.base-wrapper{margin-top:64px;padding:2.625rem 1rem}.not-found-background{aspect-ratio:9/20;user-select:none}}.messager{background-color:var(--background-color);border:1px solid var(--card-background-border-color);border-radius:.5rem;box-shadow:0 0 .8rem var(--card-box-shadow);left:0;margin-left:auto;margin-right:auto;max-width:200px;padding:.5rem 1rem;position:fixed;right:0;text-align:center;top:1rem;-webkit-transform:scale(.2);transform:scale(.2);transition:.2s;z-index:1000}.footer{background-color:#212121;color:#efefef;font-size:15px;height:184px;justify-content:space-evenly;position:relative;-webkit-user-select:none;-ms-user-select:none;user-select:none}.footer,.footer .wrapper{display:flex;flex-direction:row}.footer .wrapper{align-items:center;justify-content:space-around;padding:.5rem;width:100%}.footer .wrapper div{margin:0 8px}.footer h3{font-size:1.6rem;font-weight:lighter;margin-top:8px;width:100%}.footer p{line-height:1.2rem;margin:0;padding:.5rem 0;text-align:center}.footer span{cursor:pointer;font-size:1.6rem;margin-right:12px}.wrapper li{padding:4px 0}.footer span:hover{color:var(--blue)}@media (max-width:750px){.footer .wrapper{flex-direction:column!important;margin-bottom:1rem;width:100%}}.navbar{background-color:#212121;box-shadow:0 0 1rem rgba(0,0,0,.1);font-family:Lato,Georgia,serif;height:64px;min-width:350px;padding:12px 0;-webkit-user-select:none;-ms-user-select:none;user-select:none;width:100%}.navbar nav{align-items:center;display:flex;flex-direction:row;justify-content:space-evenly;max-width:1080px;min-width:375px;width:64%}.nav-link .img-label{font-size:15px;min-width:54px;padding-left:2px}@media (max-width:750px){.navbar{position:absolute;z-index:10}.nav-link .img-label{display:none}}.nav-link{align-items:center;color:#fff;cursor:pointer;display:flex;flex-direction:row;font-size:2.2rem;justify-content:center;margin:0 1rem;min-width:3rem;transition:.2s}.nav-link>img{border-radius:50%;display:inline-block;height:2rem}.nav-link:hover{color:var(--blue);text-decoration:none}.nav-link .link-label{display:block;font-size:16px;text-align:center;width:8rem}.link-active{color:var(--blue)}.game .question{margin:1.5rem 0}.game .question input{-webkit-appearance:none;appearance:none;background:none;border:none;border-bottom:1px solid var(--font-color);color:var(--font-color);display:inline-block;font-weight:700;max-width:120px;outline:none;padding:1px 8px}.game .question button{background:var(--card-background-color);border-radius:4px;color:var(--font-color);cursor:pointer;font-size:12px;margin-left:8px;padding:2px 6px}.game img{aspect-ratio:16/9;border-radius:8px;height:auto;margin-bottom:.5rem;margin-top:1rem;overflow:hidden;padding:0;width:100%}.game img,.lamp{position:relative}.lamp{--lamp-lightness:60%;--lamp-color:hsl(0deg 0% var(--lamp-lightness));--outline-offset:var(--sp--3);--outline-color:#fff;background-color:transparent;cursor:pointer;height:45px;-webkit-transform:scale(.711);transform:scale(.711);-webkit-transform-style:preserve-3d;transform-style:preserve-3d;width:45px}.lamp>*{display:block}.lamp-base{background-color:var(--lamp-color);border-radius:4px 4px 0 0;bottom:0;box-shadow:inset 0 .5px 2px rgba(0,0,0,.6);height:7px;position:absolute;right:5px;-webkit-transform-style:preserve-3d;transform-style:preserve-3d;width:30px}.lamp-base-down:after{height:0!important}.lamp-base:after{background-color:#fff;border-radius:1px 1px 0 0;content:"";height:6px;left:4px;position:absolute;top:-2px;-webkit-transform:translateZ(-1px);transform:translateZ(-1px);width:6px}.lamp-neck{bottom:5px;right:8px;-webkit-transform:translateZ(-1px) rotate(20deg);transform:translateZ(-1px) rotate(20deg)}.lamp-neck,.lamp-neck:after{background-color:var(--lamp-color);height:20px;position:absolute;width:4px}.lamp-neck:after{content:"";left:-8px;top:-14px;-webkit-transform:rotate(-60deg);transform:rotate(-60deg)}.lamp-head{--lamp-color-light:hsl(0deg 0% calc(var(--lamp-lightness) - 5%));background-image:linear-gradient(to bottom,var(--lamp-color-light) 5%,var(--lamp-color) 90%,var(--lamp-color-light) 5%);border-radius:100px 100px 0 0;box-shadow:0 4px 4px -2px #e6e6e6;height:10px;left:10px;position:absolute;top:4px;-webkit-transform:rotate(45deg);transform:rotate(45deg);-webkit-transform-style:preserve-3d;transform-style:preserve-3d;width:20px}.lamp-head:before{background-color:var(--lamp-color);border-radius:50%;display:block;height:6px;right:6px;top:-4px;width:6px px}.lamp-head:after,.lamp-head:before{content:"";position:absolute;-webkit-transform:translateZ(-1px);transform:translateZ(-1px)}.lamp-head:after{background:var(--lamp-head-background);-webkit-clip-path:polygon(30% 0,70% 0,100% 100%,0 100%);clip-path:polygon(30% 0,70% 0,100% 100%,0 100%);height:40px;right:0;top:10px;width:20px}:root{--deckgo-highlight-code-font-family:source-code-pro,Menlo,Monaco,Consolas,Courier New,monospace}html[data-theme=dark]{--blue:#02bbff;--background-color:#141414;--background-color-transparent:rgba(0,0,0,.9);--font-color:#dedede;--font-color-header:#fff;--font-color-highlight:#efefef;--btn-color:#333;--card-background-color:#222;--quote-background-color:#242424;--font-color-quote:#bdcbdc;--card-background-border-color:#2a2a2a;--card-box-shadow:#333;--code-font-color:#c678dd;--code-background-color:rgba(0,0,0,.1);--code-border-color:rgba(0,0,0,.02);--code-block-background:#1c1c1c;--navigator-hover-color:hsla(0,0%,100%,.1);--navigator-border-color:#222;--table-border-color:#303030;--lamp-head-background:transparent}html[data-theme=light]{--blue:#02bbff;--background-color:#fff;--background-color-transparent:hsla(0,0%,100%,.9);--font-color:#000;--font-color-header:#3c4043;--btn-color:#fff;--card-background-color:#efefef;--card-background-border-color:#efefef;--quote-background-color:#eaf8ff;--font-color-highlight:#000;--font-color-quote:#555;--card-box-shadow:rgba(0,0,0,.1);--code-font-color:#444;--code-background-color:rgba(255,229,100,.2);--code-border-color:rgba(255,229,100,.2);--code-block-background:#313131;--navigator-hover-color:rgba(0,0,0,.08);--navigator-border-color:#ddd;--table-border-color:#ededed;--lamp-head-background:linear-gradient(hsla(0,0%,100%,.8),hsla(0,0%,100%,.35),hsla(0,0%,100%,.05))}html{background-color:#212121;border:none}body{background-color:var(--background-color);color:var(--font-color);font-family:Lato,Georgia,serif}a{color:inherit;text-decoration:none}*{-webkit-tap-highlight-color:rgba(0,0,0,0);border:none;box-sizing:border-box;list-style-type:none;margin:0;padding:0}ol{margin:.7rem 0}ol li{list-style-type:decimal;margin:.6rem 0 .6rem 2rem}p{-webkit-margin-before:1em;-webkit-margin-after:1em;-webkit-margin-start:0;-webkit-margin-end:0;display:block;line-height:1.8;margin-block-end:1em;margin-block-start:1em;margin-bottom:.7rem;margin-inline-end:0;margin-inline-start:0;margin-top:.7rem}::selection{background-color:var(--blue);color:#fff}body{word-wrap:break-word;font-kerning:normal;margin:0;padding:0}header{align-items:center;display:flex;flex-direction:row;justify-content:space-around;padding-bottom:0}header>.route-link{margin:0 1rem}.layout{display:flex;flex-direction:row}.base-wrapper{margin-left:auto;margin-right:auto;max-width:1080px;min-height:100%;min-width:350px;padding:2.625rem 1.3125rem;width:60%}.article-body .article-title{font-size:2.2rem;font-weight:700;margin-bottom:2rem;text-align:center}.article-body strong{color:var(--font-color-highlight)}.article-meta{font-size:.9rem;margin:1rem auto;margin-bottom:3rem!important;text-align:center}.article-meta>span{background-color:var(--card-background-color);border-radius:.5rem;font-weight:lighter;padding:.5rem 1rem}.article-body h1,h2,h3{cursor:pointer}.article-body p{font-size:16px;font-weight:400;margin-bottom:1.2rem;margin-top:1.2rem}.article-body h1{color:var(--font-color-header);font-size:2rem;font-weight:700;margin-bottom:1.8rem;margin-top:3.5rem}.article-body h1 code{font-size:2rem}.article-body h2{color:var(--font-color-header);font-size:1.6rem;font-weight:700;margin-bottom:1rem;margin-top:2.5rem}.article-body h2 code{font-size:1.5rem}.article-body h3{color:var(--font-color-header);font-size:1.3rem;font-weight:700;line-height:1.8;margin-bottom:1rem;margin-top:1.8rem}.article-body h3 code{font-size:1.2rem;font-weight:700}.article-body h4{color:var(--font-color-header);font-weight:500;margin-bottom:1rem;margin-top:1.5rem}.article-body h4 code{font-size:1rem}.article-body h1:first-child{border-radius:.5rem}.article-body h1:not(:first-child):before{margin-bottom:.5rem}.article-body h1:not(:first-child):before,.article-body h2:before{background:var(--blue);content:"";display:block;height:2px;width:70px}.article-body h2:before{margin-bottom:.3rem}.article-body code{background-color:var(--code-background-color);border:1px solid var(--code-border-color);border-radius:4px;color:var(--code-font-color);font-family:Menlo,Monaco,Consolas,monospace;font-size:15px;margin:0 2px;padding:1px 4px}.article-body blockquote{background-color:var(--quote-background-color);border-left:2px solid var(--blue);border-radius:0 .5rem .5rem 0;color:var(--font-color-quote);margin-top:1rem;padding:1rem}.article-body blockquote code{color:var(--code-font-color)}.article-body .article-cover{border-radius:16px;box-shadow:0 0 1px rgba(0,0,0,.1);margin:18px auto 20px;width:80%}.article-body .article-cover,.article-body img{display:block;min-width:330px;-o-object-fit:cover;object-fit:cover}.article-body img{border-radius:12px;margin:18px auto;width:85%}.article-body ul{margin:.7rem 0}.article-body ul li{list-style-type:disc;margin:.6rem 0 .6rem 2rem}.article-body a{color:#189fff}a:hover{text-decoration:underline}.article-body a:after{content:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMSIgaGVpZ2h0PSIxMSIgY2xhc3M9InByZWZpeF9faWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCI+PHBhdGggZmlsbD0iIzE4OWZmZiIgZD0iTTkyNC40MDIgMTAyMy4wNjhILjY4Vjk5LjM0NUg0NjIuNTR2OTguOTFIOTkuNTk3VjkyNC4xNWg3MjUuODk2VjU2MS4yMDdoOTguOTF6Ii8+PHBhdGggZmlsbD0iIzE4OWZmZiIgZD0ibTkzMC44MDUgMjIuOTc3IDY5Ljk2NiA2OS45NjYtNDUzLjQ5MyA0NTMuNDkyLTY5Ljk2NS02OS45MDF6Ii8+PHBhdGggZmlsbD0iIzE4OWZmZiIgZD0iTTEwMjIuNDY0IDMwNC4wM2gtOTguOTE3Vjk5LjM0NUg3MDkuMjMxVi40MjhoMzEzLjIzM3oiLz48L3N2Zz4=);padding-left:2px}.article-body table{word-wrap:normal;border-collapse:collapse;table-layout:fixed;width:100%}th{background-color:rgba(0,0,0,.06);text-align:center}td{background-color:hsla(0,0%,100%,.01);font-weight:300}table,td,th{border:1px solid var(--table-border-color);overflow:auto;padding:.5rem}.theme-changer{border-radius:50%;bottom:1rem;cursor:pointer;position:fixed;right:1rem}.theme-changer img{background-color:var(--background-color);border:1px solid var(--card-background-border-color);border-radius:50%;height:30px;padding:6px;width:30px}.iframe-wrapper{aspect-ratio:16/9;border-radius:8px;height:auto;margin-bottom:.5rem;margin-top:1rem;overflow:hidden;padding:0;position:relative;width:100%}.iframe-wrapper .loader{color:#dcdcdc;font-family:sans-serif;font-size:2.5rem;left:50%;position:absolute;text-align:center;top:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);-webkit-user-select:none;-ms-user-select:none;user-select:none}iframe{aspect-ratio:16/9;height:auto;width:100%}deckgo-highlight-code{background-color:var(--code-block-background);border-radius:.5rem;box-shadow:none!important;cursor:pointer;font-size:14px;margin-top:1rem;position:relative}.not-found-background,deckgo-highlight-code{-webkit-user-select:none;-ms-user-select:none;user-select:none}.not-found-background{aspect-ratio:16/9}.not-found-background h1{background-color:rgba(0,0,0,.8);border-radius:8px;box-shadow:0 0 3rem rgba(0,0,0,.9);color:#ef3939;margin-top:4rem;padding:8px;text-align:center}@media (min-width:900px){deckgo-highlight-code:after{content:"双击复制";font-size:11px;height:2rem;opacity:0;position:absolute;right:1rem;text-align:center;top:1rem;transition:.4s;width:4rem}deckgo-highlight-code:hover:after{opacity:1}}@media (max-width:1100px){.base-wrapper[name=article-wrapper]{margin-left:0;padding-left:0;padding-right:0;width:75%}.base-wrapper{width:80%}.article-body h1,.article-body h2,.article-body h3,.article-body p{padding-left:.8rem;padding-right:.8rem}.article-body li{padding-right:.8rem}.article-body img,.iframe-wrapper,blockquote,deckgo-highlight-code{border-radius:0!important}.article-body img{width:100%}}@media (max-width:750px){.base-wrapper[name=article-wrapper]{padding:2.625rem 0}.base-wrapper,.base-wrapper[name=article-wrapper]{margin-left:auto;margin-right:auto;min-height:100%;width:100%}.base-wrapper{margin-top:64px;padding:2.625rem 1rem}.not-found-background{aspect-ratio:9/20;-webkit-user-select:none;-ms-user-select:none;user-select:none}}.avatar{align-items:center;display:flex;flex-direction:row;height:8rem;justify-content:center}.avatar>img{border-radius:50%;box-shadow:0 0 4px rgba(0,0,0,.1);max-height:100%;-o-object-fit:cover;object-fit:cover;-o-object-position:center center;object-position:center center;opacity:1;padding:.5rem;transition:none 0s ease 0s}.progresser{background-color:var(--background-color);border:1px solid var(--card-background-border-color);border-radius:15px 0 0 15px;bottom:4rem;color:var(--font-color);cursor:pointer;font-family:Courier New,Courier,monospace;font-size:13px;font-weight:lighter;height:30px;line-height:30px;position:fixed;right:0;text-align:center;transition:.2s;-webkit-user-select:none;-ms-user-select:none;user-select:none;width:48px;z-index:9}.progresser:after{background-color:var(--quote-background-color);border-radius:15px 0 0 15px;content:"";opacity:0;transition:.2s}.progresser:after,.progresser:hover:after{bottom:0;left:0;position:absolute;right:0;top:0}.progresser:hover:after{content:"up";opacity:1}.progresser-hide{-webkit-transform:translateX(100%);transform:translateX(100%)}.table-of-content{background-color:var(--background-color);border-left:1px solid var(--card-background-border-color);height:100vh;position:-webkit-sticky;position:sticky;top:0;-webkit-user-select:none;-ms-user-select:none;user-select:none;width:20%}.table-of-content-main{height:100%;overflow-y:auto;padding:2.5rem 1.2rem 3rem}.table-of-content-main::-webkit-scrollbar{width:0}.table-of-content-switch{display:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.table-of-content-visible{-webkit-transform:translateX(0)!important;transform:translateX(0)!important}@media (max-width:1100px){.table-of-content{width:25%}}@media (max-width:750px){.table-of-content{-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);background-color:var(--background-color-transparent);border:none;box-shadow:0 0 8px rgba(0,0,0,.1);height:100%;max-width:400px;padding:0;position:fixed;right:0;-webkit-transform:translateX(100%);transform:translateX(100%);transition:.3s;width:calc(100% - 80px);z-index:11}p.header-level-h1:first-child{padding-left:14px!important;-webkit-transform:translateX(0);transform:translateX(0)}.table-of-content-main{padding:2rem 0}.table-of-content h4{font-size:1.2rem!important;margin-top:1rem!important;padding-left:1rem;padding-right:1rem}.table-of-content p{border-bottom:1px solid var(--navigator-border-color);font-size:1rem!important;line-height:2.8rem!important;margin-top:0!important;padding-right:2rem!important;transition:background .3s}.table-of-content p.header-level-h1{font-weight:700;margin-top:.8rem;padding-left:2rem}.table-of-content p.header-level-h2{font-size:15px;margin-top:.4rem;padding-left:3rem}.table-of-content .header-level-h3{font-size:15px;margin-top:.2rem;padding-left:4rem}.table-of-content p:hover{background:var(--navigator-hover-color)}.table-of-content-switch{background-color:blue;background-color:var(--background-color);border:1px solid var(--card-background-border-color);border-radius:50%;color:var(--font-color);cursor:pointer;display:block;font-size:.8rem;height:30px;line-height:30px;position:fixed;right:.5rem;text-align:center;top:4.5rem;width:30px;z-index:8}}.table-of-content::-webkit-scrollbar{display:none}.table-of-content p{cursor:pointer;margin:0;overflow-x:hidden;text-overflow:ellipsis;white-space:nowrap;width:100%}.table-of-content .topHeader{color:var(--blue)!important}.table-of-content p:hover{color:var(--blue)}p.header-level-h1:first-child{border-left:2px solid var(--blue);padding-left:4px;-webkit-transform:translateX(-8px);transform:translateX(-8px)}p.header-level-h1{font-size:15px;font-weight:700;margin-top:.8rem}p.header-level-h2{font-size:14px;margin-top:.4rem;padding-left:1rem}p.header-level-h3{font-size:14px;margin-top:.2rem;padding-left:2rem}</style><meta name="generator" content="Gatsby 4.4.0"/><link rel="icon" href="/favicon-32x32.png?v=d58da36a3a1345ad1c6bcba6e7d0c6de" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="use-credentials"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=d58da36a3a1345ad1c6bcba6e7d0c6de"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=d58da36a3a1345ad1c6bcba6e7d0c6de"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=d58da36a3a1345ad1c6bcba6e7d0c6de"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=d58da36a3a1345ad1c6bcba6e7d0c6de"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=d58da36a3a1345ad1c6bcba6e7d0c6de"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=d58da36a3a1345ad1c6bcba6e7d0c6de"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=d58da36a3a1345ad1c6bcba6e7d0c6de"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=d58da36a3a1345ad1c6bcba6e7d0c6de"/><link as="script" rel="preload" href="/webpack-runtime-be4e6448a97e15bbfe34.js"/><link as="script" rel="preload" href="/framework-f27b074ecebec0f1dbc4.js"/><link as="script" rel="preload" href="/app-9219071c395ef3fffffa.js"/><link as="script" rel="preload" href="/cb1608f2-11f3b27bb6d43c4002d7.js"/><link as="script" rel="preload" href="/a9a7754c-d1e0ec91a76ed49794d7.js"/><link as="script" rel="preload" href="/commons-8aa8ea61781968697067.js"/><link as="script" rel="preload" href="/component---src-pages-articles-mdx-slug-js-7c025e8ce7d57a030f06.js"/><link as="fetch" rel="preload" href="/page-data/articles/redbook-series/redbook-chapter02/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/2757060725.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/3605573801.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><title>Louis K - Software Engineer</title><header class="navbar"><nav><div class="nav-link"><img alt="avatar" src="/static/avatar-05f3b9b1e1ce151053fb8a66dbc70489.png"/><span class="img-label">Louis K</span></div><a class="nav-link" href="/"><span class="link-label">Tech</span></a><a class="nav-link" href="/nonTech/"><span class="link-label">Ramble</span></a><div class="nav-link"><button class="lamp" aria-pressed="true" type="button"><span class="lamp-base"></span><span class="lamp-neck"></span><span class="lamp-head"></span></button></div></nav></header><main class="layout"><div class="article-navigator-switch"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="list" class="svg-inline--fa fa-list " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M88 48C101.3 48 112 58.75 112 72V120C112 133.3 101.3 144 88 144H40C26.75 144 16 133.3 16 120V72C16 58.75 26.75 48 40 48H88zM480 64C497.7 64 512 78.33 512 96C512 113.7 497.7 128 480 128H192C174.3 128 160 113.7 160 96C160 78.33 174.3 64 192 64H480zM480 224C497.7 224 512 238.3 512 256C512 273.7 497.7 288 480 288H192C174.3 288 160 273.7 160 256C160 238.3 174.3 224 192 224H480zM480 384C497.7 384 512 398.3 512 416C512 433.7 497.7 448 480 448H192C174.3 448 160 433.7 160 416C160 398.3 174.3 384 192 384H480zM16 232C16 218.7 26.75 208 40 208H88C101.3 208 112 218.7 112 232V280C112 293.3 101.3 304 88 304H40C26.75 304 16 293.3 16 280V232zM88 368C101.3 368 112 378.7 112 392V440C112 453.3 101.3 464 88 464H40C26.75 464 16 453.3 16 440V392C16 378.7 26.75 368 40 368H88z"></path></svg></div><div class="article-navigator"><h4>electron</h4><p title="electron中的进程模型" class="">electron中的进程模型</p><h4>前端杂谈</h4><p title="“关于Unicode和字符集，你至少应该了解这些”" class="">“关于Unicode和字符集，你至少应该了解这些”</p><p title="跨源资源共享（CORS）" class="">跨源资源共享（CORS）</p><p title="V8引擎中的对象属性访问" class="">V8引擎中的对象属性访问</p><p title="关于no-cors的误区" class="">关于no-cors的误区</p><p title="地图工具中的线条吸附——一个简单方案" class="">地图工具中的线条吸附——一个简单方案</p><p title="渲染页面：浏览器的工作原理" class="">渲染页面：浏览器的工作原理</p><p title="React diffing算法" class="">React diffing算法</p><p title="Vercel简介 静态博客部署" class="">Vercel简介 静态博客部署</p><h4>JavaScript数据结构和算法</h4><p title="（八）字典和散列表" class="">（八）字典和散列表</p><p title="（十）树" class="">（十）树</p><p title="（十四）算法设计与技巧" class="">（十四）算法设计与技巧</p><h4>JavaScript高级程序设计</h4><p title="（一）什么是JavaScript？" class="">（一）什么是JavaScript？</p><p title="（二）HTML中的JavaScript" class="highlighted-navigator-item">（二）HTML中的JavaScript</p><p title="（三）JavaScript语言基础" class="">（三）JavaScript语言基础</p><p title="（四）变量、作用域与内存" class="">（四）变量、作用域与内存</p><p title="（五）基本引用类型" class="">（五）基本引用类型</p><p title="（六）集合引用类型" class="">（六）集合引用类型</p><p title="（七）迭代器与生成器" class="">（七）迭代器与生成器</p><p title="（十一）期约与异步函数" class="">（十一）期约与异步函数</p><p title="（十四）DOM" class="">（十四）DOM</p><p title="（十五）DOM扩展" class="">（十五）DOM扩展</p><p title="（十七）事件" class="">（十七）事件</p><p title="（二十）JavaScript API" class="">（二十）JavaScript API</p><p title="（二十三）JSON" class="">（二十三）JSON</p><p title="（二十四）网络请求与远程资源" class="">（二十四）网络请求与远程资源</p><p title="（二十五）客户端存储" class="">（二十五）客户端存储</p><p title="（二十六）模块" class="">（二十六）模块</p></div><main class="base-wrapper" name="article-wrapper"><main><div class="progresser">0<!-- -->%</div><article class="article-body" style="margin-bottom:4rem"><h1 class="article-title">（二）HTML中的JavaScript</h1><p class="article-meta"><span><span role="img" aria-label="field-time" class="anticon anticon-field-time"><svg viewBox="64 64 896 896" focusable="false" data-icon="field-time" width="1em" height="1em" fill="currentColor" aria-hidden="true"><defs><style></style></defs><path d="M945 412H689c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h256c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zM811 548H689c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h122c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zM477.3 322.5H434c-6.2 0-11.2 5-11.2 11.2v248c0 3.6 1.7 6.9 4.6 9l148.9 108.6c5 3.6 12 2.6 15.6-2.4l25.7-35.1v-.1c3.6-5 2.5-12-2.5-15.6l-126.7-91.6V333.7c.1-6.2-5-11.2-11.1-11.2z"></path><path d="M804.8 673.9H747c-5.6 0-10.9 2.9-13.9 7.7a321 321 0 01-44.5 55.7 317.17 317.17 0 01-101.3 68.3c-39.3 16.6-81 25-124 25-43.1 0-84.8-8.4-124-25-37.9-16-72-39-101.3-68.3s-52.3-63.4-68.3-101.3c-16.6-39.2-25-80.9-25-124 0-43.1 8.4-84.7 25-124 16-37.9 39-72 68.3-101.3 29.3-29.3 63.4-52.3 101.3-68.3 39.2-16.6 81-25 124-25 43.1 0 84.8 8.4 124 25 37.9 16 72 39 101.3 68.3a321 321 0 0144.5 55.7c3 4.8 8.3 7.7 13.9 7.7h57.8c6.9 0 11.3-7.2 8.2-13.3-65.2-129.7-197.4-214-345-215.7-216.1-2.7-395.6 174.2-396 390.1C71.6 727.5 246.9 903 463.2 903c149.5 0 283.9-84.6 349.8-215.8a9.18 9.18 0 00-8.2-13.3z"></path></svg></span> <!-- -->2022-01-09<!-- --> | <span role="img" aria-label="read" class="anticon anticon-read"><svg viewBox="64 64 896 896" focusable="false" data-icon="read" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M928 161H699.2c-49.1 0-97.1 14.1-138.4 40.7L512 233l-48.8-31.3A255.2 255.2 0 00324.8 161H96c-17.7 0-32 14.3-32 32v568c0 17.7 14.3 32 32 32h228.8c49.1 0 97.1 14.1 138.4 40.7l44.4 28.6c1.3.8 2.8 1.3 4.3 1.3s3-.4 4.3-1.3l44.4-28.6C602 807.1 650.1 793 699.2 793H928c17.7 0 32-14.3 32-32V193c0-17.7-14.3-32-32-32zM324.8 721H136V233h188.8c35.4 0 69.8 10.1 99.5 29.2l48.8 31.3 6.9 4.5v462c-47.6-25.6-100.8-39-155.2-39zm563.2 0H699.2c-54.4 0-107.6 13.4-155.2 39V298l6.9-4.5 48.8-31.3c29.7-19.1 64.1-29.2 99.5-29.2H888v488zM396.9 361H211.1c-3.9 0-7.1 3.4-7.1 7.5v45c0 4.1 3.2 7.5 7.1 7.5h185.7c3.9 0 7.1-3.4 7.1-7.5v-45c.1-4.1-3.1-7.5-7-7.5zm223.1 7.5v45c0 4.1 3.2 7.5 7.1 7.5h185.7c3.9 0 7.1-3.4 7.1-7.5v-45c0-4.1-3.2-7.5-7.1-7.5H627.1c-3.9 0-7.1 3.4-7.1 7.5zM396.9 501H211.1c-3.9 0-7.1 3.4-7.1 7.5v45c0 4.1 3.2 7.5 7.1 7.5h185.7c3.9 0 7.1-3.4 7.1-7.5v-45c.1-4.1-3.1-7.5-7-7.5zm416 0H627.1c-3.9 0-7.1 3.4-7.1 7.5v45c0 4.1 3.2 7.5 7.1 7.5h185.7c3.9 0 7.1-3.4 7.1-7.5v-45c.1-4.1-3.1-7.5-7-7.5z"></path></svg></span> <!-- -->2800<!-- -->words <!-- -->10<!-- -->min</span></p><p>将 JavaScript 引入网页，首先要解决它与网页主导语言 HTML 的关系问题。在 JavaScript 早期，网景公司的工作人员希望在将 JavaScript 引入 HTML 页面的同时，不会导致页面在其他浏览器中渲染出问题。通过反复试错和讨论，他们最终做出了一些决定，并达成了向网页中引入通用脚本能力的共识。当初他们的很多工作得到了保留，并且最终形成了 HTML 规范。</p><h1><code>&lt;script&gt;</code>元素</h1><p>将 JavaScript 插入 HTML 的主要方法是使用<code>&lt;script&gt;</code>元素。这个元素是由网景公司创造出来，并最早在 Netscape Navigator 2 中实现的。后来这个元素被正式添加到 HTML 规范。<code>&lt;script&gt;</code>元素有下列 8 个属性：</p><ul><li><code>async</code>：可选。表示应该立即开始下载脚本，但不能阻止其他页面动作，例如下载资源或等待其他脚本加载。只对外部脚本文件有效。</li><li><code>charset</code>：可选。使用<code>src</code>属性指定的代码字符集。这个属性很少使用，因为大多数浏览器不在乎它的值。</li><li><code>crossorigin</code>：可选。配置相关相关请求的 CORS 设置。默认不使用 CORS。<code>crossorigin=&quot;anonymous&quot;</code>配置文件请求不必设置凭据标志。<code>crossorigin=&quot;use-credentials&quot;</code>设置凭据标志，意味着出站请求会包含凭据。</li><li><code>defer</code>：可选。表示脚本可以延迟到文档完全被解析和显示之后再执行。只对外部脚本文件有效。</li><li><code>integrity</code>：可选。允许比对接收到的资源和指定的加密签名来验证子资源完整性（SRI，Subresource Integrity）。如果接收到的资源的签名与这个属性指定的签名不匹配，则页面会报错。脚本不会执行。这个属性可以用于确保内容分发网络（CDN，Content Delivery Network）不会提供恶意内容。</li><li><code>language</code>：废弃。最初用于表示代码快中的脚本语言（如<code>&quot;JavaScript&quot;</code>、<code>&quot;JavaScript1.2&quot;</code>、<code>&quot;VBScript&quot;</code>）。大多数浏览器都会忽略这个属性，不应该再使用它。</li><li><code>src</code>：可选。表示包含要执行的代码的外部文件。</li><li><code>type</code>：可选。代理<code>language</code>，表示代码块中脚本语言的内容类型（也称 MIME 类型）。按照惯例，这个值始终都是<code>&quot;text/javascript&quot;</code>，尽管<code>&quot;text/javascript&quot;</code>和<code>&quot;text/ecmascript&quot;</code>都已经废弃了。JavaScript 文件的 MIME 类型通常是<code>&quot;application/x-javascript&quot;</code>，不过给<code>&quot;type&quot;</code>属性这个值有可能导致脚本被忽略。在非 IE 浏览器中有效的其他值还有<code>&quot;application/javascript&quot;</code>和<code>application/ecmascript</code>。如果这个值是<code>module</code>，则代码会被当成 ES6 模块，而且只有这时候，代码中才能出现<code>import</code>和<code>export</code>关键字。</li></ul><p>使用<code>&lt;script&gt;</code>的方式有两种：通过它直接在网页中嵌入 JavaScript 代码，以及通过它在网页中包含外部 JavaScript 文件。</p><p>要嵌入行内 JavaScript 代码，直接把代码放在<code>&lt;script&gt;</code>元素中就行：</p><deckgo-highlight-code language="html" theme="one-dark">
          <code slot="code">&lt;script&gt;
  function sayHi() {
    console.log(&#x27;Hi!&#x27;)
  }
&lt;/script&gt;</code>
        </deckgo-highlight-code><p>包含在<code>&lt;script&gt;</code>标签内的代码会被从上倒下解释。在上面的例子中，被解释的是一个函数定义，并且该函数会被保存在解释器环境中。在<code>&lt;script&gt;</code>元素中的代码被计算完成之前，页面的其余内容不会被加载，也不会被显示。</p><p>在使用行内 JavaScript 代码时，要注意代码中不能出现字符串<code>&lt;/script&gt;</code>，需要转义<code>/</code>字符才行。</p><p>要包含外部文件中的 JavaScript 就必须使用<code>src</code>属性。这个属性的值是一个 URL，指向包含 JavaScript 代码的文件。例如：</p><deckgo-highlight-code language="html" theme="one-dark">
          <code slot="code">&lt;script src=&quot;example.js&quot;&gt;&lt;/script&gt;</code>
        </deckgo-highlight-code><p>这个例子在页面中加载了一个名为 example.js 的外部文件。文件本身只需要包含放在<code>&lt;script&gt;</code>的起始及结束标签中间的 JavaScript 代码。与解释行内 JavaScript 一样，在解释外部 JavaScript 文件时，页面也会阻塞。（阻塞时间也包含下载文件的时间。）</p><blockquote><p>按照惯例，外部 JavaScript 文件的扩展名是.js。实际上这并不是必须的，因为浏览器不会检查所包含 JavaScript 文件的扩展名。这就为使用服务器端脚本语言动态生成 JavaScript 代码或在浏览器中将 JavaScript 扩展语言（如 TypeScript，JSX）转义为 JavaScript 代码提供了可能性。不过要注意，服务器经常会根据文件扩展来确定响应的正确 MIME 类型。</p></blockquote><p>另外，使用了<code>src</code>属性的<code>&lt;script</code>元素不应该再在标签内部包含其他 JavaScript 代码。如果两者都提供的话，浏览器只会下载并执行脚本文件，忽略行内的代码。</p><p><code>&lt;script&gt;</code>元素一个最为强大、同时也备受争议的特性是，它可以包含来自外部域的 JavaScript 文件。根<code>&lt;img&gt;</code>元素很像，<code>&lt;script&gt;</code>元素的<code>src</code>属性可以是一个完整的 URL，而且这个 URL 指向的资源可以跟包含它的 HTML 页面不在同一个域中。</p><deckgo-highlight-code language="html" theme="one-dark">
          <code slot="code">&lt;script src=&quot;http://www.somewhere.com/afile.js&quot;&gt;&lt;/script&gt;</code>
        </deckgo-highlight-code><p>浏览器在解析这个资源时，会向<code>src</code>属性指定的路径发送一个 GET 请求，以取得相应资源，假定是一个 JavaScript 文件。这个初始的请求不受浏览器同源策略限制，但返回并被执行的 JavaScript 则受限制。当然，这个请求仍然受父页面 HTTP/HTTPS 协议的限制。</p><p>来自外部域的代码会被当成加载它的页面的一部分来加载和解释。这个能力可以让我们通过不同的域分发 JavaScript。不过，引用了放在别人服务器上的 JavaScript 文件要格外小心，因为恶意的程序员随时可能替换这个文件。在包含外部域的 JavaScript 文件时，要确保该域是自己所有的，或者该域是一个可信的来源。<code>&lt;script&gt;</code>标签的<code>integrity</code>属性是防范这种问题的一个武器，但这个属性也不是所有浏览器都支持。</p><p>不管包含的是什么代码，浏览器都会按照<code>&lt;script&gt;</code>在页面中出现的顺序依次解释它们，前提是它们没有使用<code>defer</code>和<code>async</code>属性。第二个<code>&lt;script&gt;</code>元素的代码必须在第一个<code>&lt;script&gt;</code>元素的代码解释完毕才能开始解释，第三个则必须等第二个解释完，以此类推。</p><h2>标签位置</h2><p>过去，所有的<code>&lt;script&gt;</code>元素都被放在页面的<code>&lt;head&gt;</code>标签内，如下面的例子所示：</p><deckgo-highlight-code language="html" theme="one-dark">
          <code slot="code">&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;demo page&lt;/title&gt;
    &lt;script src=&quot;example1.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;example2.js&quot;&gt;&lt;/script&gt;
  &lt;/head&gt;

  &lt;body&gt;
    &lt;!-- 页面内容 --&gt;
  &lt;/body&gt;
&lt;/html&gt;</code>
        </deckgo-highlight-code><p>这种做法的主要目的是把外部的 CSS 和 JavaScript 文件都集中放到一起。不过，把所有 JavaScript 文件都放在<code>&lt;head&gt;</code>里，也就意味着必须把所有的 JavaScript 代码都下载、解析和执行完成后，才能开始渲染页面（页面在浏览器解析到<code>&lt;body&gt;</code>的起始标签时开始渲染）。对于需要很多 JavaScript 的页面，这会导致页面渲染的明显延迟，在此期间浏览器窗口完全空白。为解决这个问题，现代 Web 应用程序通常将所有 JavaScript 引用放在<code>&lt;body&gt;</code>元素中的页面内容后面。</p><deckgo-highlight-code language="html" theme="one-dark">
          <code slot="code">&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;demo page&lt;/title&gt;
  &lt;/head&gt;

  &lt;body&gt;
    &lt;!-- 页面内容 --&gt;
    &lt;script src=&quot;example1.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;example2.js&quot;&gt;&lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;</code>
        </deckgo-highlight-code><p>这样一来，页面会在加载 JavaScript 代码之前解析初始的 HTML 文件。用户会感觉页面加载更快了，因为浏览器显示空白页面的时间更短了。</p><blockquote><p>注意，书中原文“这样一来，页面会在处理 JavaScript 代码之前完全渲染页面。用户会感觉页面加载更快了，因为浏 览器显示空白页面的时间短了”，这里是有错误的，放在<code>&lt;body&gt;</code>标签底部的<code>&lt;script&gt;</code>文件在被解析到时就立即加载，<code>&lt;script&gt;</code>标签如果没有<code>defer</code>或<code>async</code>属性，都会阻塞渲染。</p><p>浏览器获取了 HTML 文件后，就会立即开始解析，解析过程是根据 HTML 文档构建 DOM 和 CSSOM 的过程，之后才能进入渲染阶段，完成 UI 的绘制。在解析 HTML 时，遇到非阻塞资源例如图片或 css 文件时，浏览器回请求这些文件，但解析器不会被阻塞，而<code>&lt;script&gt;</code>标签会默认阻塞解析器。</p></blockquote><h2>推迟执行脚本</h2><p>HTML4.01 就为<code>&lt;script&gt;</code>元素定义了一个叫<code>defer</code>的属性。这个属性表示脚本在执行的时候不会改变页面的结构。也就是说，脚本会被延迟到整个页面都解析完毕后再运行。因此，在<code>&lt;script&gt;</code>元素上设置<code>defer</code>属性，相当于告诉浏览器立即下载，但延迟执行。</p><deckgo-highlight-code language="html" theme="one-dark">
          <code slot="code">&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;demo page&lt;/title&gt;
    &lt;script defer src=&quot;example1.js&quot;&gt;&lt;/script&gt;
    &lt;script defer src=&quot;example2.js&quot;&gt;&lt;/script&gt;
  &lt;/head&gt;

  &lt;body&gt;
    &lt;!-- 页面内容 --&gt;
  &lt;/body&gt;
&lt;/html&gt;</code>
        </deckgo-highlight-code><p>虽然这个例子中<code>&lt;script&gt;</code>元素包含在<code>&lt;head&gt;</code>中，但它们会在浏览器解析到结束的<code>&lt;/html&gt;</code>标签后才会执行。HTML5 规范要求脚本应该按照它们出现的顺序执行，因此第一个推迟的脚本应该在第二个推迟的脚本之前执行，并且两者都会在<code>DOMContentLoaded</code>事件（这个事件会在 DOM 树构建完成后立即触发，不用等待图片、JavaScript 文件、CSS 文件或其他资源加载完成）之前执行。不过在实际中，推迟执行的脚本不一定总会按顺序执行或在<code>DOMContentLoaded</code>事件之前执行，因此最好只包含一个这样的脚本。</p><p>如前所述，<code>defer</code>属性只对外部脚本文件才有效。这是 HTML5 中明确规定的，因此支持 HTML5 的浏览器会忽略行内脚本的<code>defer</code>属性。一般来说，为了兼容更多浏览器，最好还是把要推迟执行的脚本放在页面底部。</p><h2>异步执行脚本</h2><p>HTML5 为<code>&lt;script&gt;</code>元素定义了<code>async</code>属性。从改变脚本处理方式上看，<code>async</code>属性与<code>defer</code>类似。当然，它们两者也都只适用于外部脚本，都会告诉浏览器立即开始下载。不过，与<code>defer</code>不同的是，标记为<code>async</code>的脚本并不保证能按照它们出现的次序执行。</p><deckgo-highlight-code language="html" theme="one-dark">
          <code slot="code">&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;demo page&lt;/title&gt;
    &lt;script async src=&quot;example1.js&quot;&gt;&lt;/script&gt;
    &lt;script async src=&quot;example2.js&quot;&gt;&lt;/script&gt;
  &lt;/head&gt;

  &lt;body&gt;
    &lt;!-- 页面内容 --&gt;
  &lt;/body&gt;
&lt;/html&gt;</code>
        </deckgo-highlight-code><p>在这个例子中，第二个脚本可能先于第一个脚本执行。因此重点在于它们之间没有依赖关系。给脚本添加<code>async</code>的目的是告诉浏览器，不必等脚本下载和执行完之后再加载页面，同样也不必等到该异步脚本下载和执行后再添加其他脚本。正因如此，异步脚本不应该再加载期间修改 DOM。</p><p>异步脚本保证会在页面的<code>load</code>事件前执行，但可能会在<code>DOMContentLoaded</code>之前或之后。</p><h2>动态加载脚本</h2><p>除了<code>&lt;script&gt;</code>标签，还有其他方式可以加载脚本。因为 JavaScript 可以使用 DOM API，所以通过向 DOM 中动态添加<code>script</code>元素同样可以加载指定的脚本。只要创建一个<code>script</code>元素并将其添加到 DOM 即可。</p><deckgo-highlight-code language="jsx" theme="one-dark">
          <code slot="code">const script = document.createElement(&#x27;script&#x27;)
script.src = &#x27;gibberish.js&#x27;
document.head.appendChild(script)</code>
        </deckgo-highlight-code><p>当然，在把<code>HTMLElement</code>元素添加到 DOM 且执行到这段代码之前不会发送请求。默认情况下，以这种方式创建的<code>&lt;script&gt;</code>元素是以异步方式加载的，相当于添加了<code>async</code>属性。不过这样做可能有问题，因为所有浏览器都支持<code>createElement()</code>方法，但不是所有浏览器都支持<code>async</code>属性。因此要统一动态脚本的加载行为，可以明确将其设置为同步加载。</p><deckgo-highlight-code language="jsx" theme="one-dark">
          <code slot="code">const script = document.createElement(&#x27;script&#x27;)
script.src = &#x27;gibberish.js&#x27;
script.async = false
document.head.appendChild(script)</code>
        </deckgo-highlight-code><p>以这种方式获取的资源对浏览器预加载器是不可见的。这回严重影响它们在资源获取队列中的优先级。根据应用程序的工作方式以及怎么使用，这种方式可能会严重影响性能。要想让预加载器知道这些动态请求文件的存在，可以在文档头部显式声明它们。</p><deckgo-highlight-code language="html" theme="one-dark">
          <code slot="code">&lt;link rel=&quot;preload&quot; href=&quot;gibberish.js&quot; /&gt;</code>
        </deckgo-highlight-code><h1>行内代码与外部文件</h1><p>虽然可以直接在 HTML 中嵌入 JavaScript 代码，但是公认的推荐实践是尽可能将 JavaScript 代码放在外部文件中。不过这个最佳实践并不是明确的强制性规则。推荐使用外部文件的理由如下：</p><ul><li><strong>可维护性</strong>。JavaScript 代码如果分散到很多 HTML 页面，会导致维护困难。而用一个目录保存所有的 JavaScript 文件，则容易维护，这样开发者就可以独立使用它们的 HTML 页面来编辑代码。</li><li><strong>缓存</strong>。浏览器会根据特定的设置缓存所有外部链接的 JavaScript 文件，这意味着如果两个页面都用到同一个文件，该文件就只需要下载一次。这最终意味着页面加载更快。</li></ul><p>在配置浏览器请求外部文件时，要重点考虑的一点是它们会占用多少带宽。在 SPDY/HTTP2 中，预请求的消耗已显著降低。以轻量、独立 JavaScript 组件形式向客户端送达脚本更具优势。</p><p>例如，第一个页面包含如下脚本：</p><deckgo-highlight-code language="html" theme="one-dark">
          <code slot="code">&lt;script src=&quot;mainA.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;component1.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;component2.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;component3.js&quot;&gt;&lt;/script&gt;</code>
        </deckgo-highlight-code><p>后续页面可能包含如下脚本：</p><deckgo-highlight-code language="html" theme="one-dark">
          <code slot="code">&lt;script src=&quot;mainB.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;component3.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;component4.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;component5.js&quot;&gt;&lt;/script&gt;</code>
        </deckgo-highlight-code><p>在初次请求时，如果浏览器支持 SPDY/HTTP2 就可以同从一个地方取得一批文件，并将它们逐个放到浏览器缓存中。从浏览器角度看，通过 SPDY/HTTP2 获取所有这些独立的资源与获取一个大的 JavaScript 文件的延迟差不多。</p><p>在第二个页面请求时，由于已经把应用程序切割成了轻量可缓存的文件，第二个页面也依赖的某些组件此时已经存在于浏览器中了。</p><p>当然，这里假设浏览器支持 SPDY/HTTP2，只有比较新的浏览器才满足。如果还想支持那些比较老的浏览器，可能还是使用一个大文件较为合适。</p><h1>文档模式</h1><p>IE5.5 发明了文档模式的概念，即可以使用<code>doctype</code>切换文档模式。最初的文档模式有两种：<strong>混杂模式</strong>（quirks mode）和<strong>标准模式</strong>（standards mode）。前者让 IE 像 IE5 一样，支持一些非标准的特性，后者让 IE 具有兼容标准的行为。虽然这两种模式的主要区别只体现在通过 CSS 渲染的内容方面，但对 JavaScript 也有一些关联影响，或称为副作用。本书会经常提到这些副作用。</p><p>IE 初次支持切换文档模式后，其他浏览器也跟着实现了。随着浏览器的普遍实现，又出现了<strong>准标准模式</strong>（almost standards mode）。这种模式下的浏览器支持很多标准的特性，但是没有标准规定的那么严格。</p><blockquote><p>在 HTML 中，文档类型的声明是必要的。在所有的文档头部时，都会看到一个<code>&quot;&lt;!DOCTYPE html&gt;&quot;</code>的身影。这个声明的目的是防止浏览器在渲染文档时，切换到”混杂模式“（也叫怪异模式、兼容模式）的渲染模式。<code>&quot;&lt;!DOCTYPE html&gt;&quot;</code>确保浏览器按照最佳的相关规范进行渲染，而不是使用一个不符合规范的渲染模式。</p></blockquote><h1><code>&lt;noscript&gt;</code>元素</h1><p>针对早期浏览器不支持 JavaScript 的问题，需要一个优雅的降级方案。最终，<code>&lt;noscript&gt;</code>元素出现，被用于给不支持 JavaScript 的浏览器提供替代内容。虽然如今的浏览器已经完全支持 JavaScript，但是有时候用户会处于安全考虑禁用 JavaScript，此时这个元素仍然有用。</p><p><code>&lt;noscript&gt;</code>元素可以包含任何可以出现在<code>&lt;body&gt;</code>中的 HTML 元素，<code>&lt;script&gt;</code>除外。在下列两种情况下，浏览器将显示<code>&lt;noscript&gt;</code>中的内容：</p><ul><li>浏览器不支持脚本</li><li>浏览器对脚本的支持被关闭</li></ul><p>任何一个条件被满足，包含在<code>&lt;noscript&gt;</code>中的内容就会被渲染。否则，浏览器不会渲染<code>&lt;noscript&gt;</code>中的内容。</p><h1>小结</h1><p>JavaScript 是通过<code>&lt;script&gt;</code>元素插入到 HTML 页面中的。这个元素可以用于把 JavaScript 代码嵌入到 HTML 页面中，跟其他标记混合在一起，也可以用于保存在外部文件中的 JavaScript。</p><ul><li>要包含外部 JavaScript 文件，必须将<code>src</code>属性设置为要包含文件的 URL。文件可以跟网页同源也可以不同源。</li><li>所有<code>&lt;script&gt;</code>元素会依照它们在网页中出现的次序被解释。在不使用<code>defer</code>和<code>async</code>属性的情况下，包含在<code>&lt;script&gt;</code>元素中的代码必须严格按次序解释。</li><li>对于不推迟执行的脚本，浏览器必须解释完位于<code>&lt;script&gt;</code>元素中的代码，然后才能继续渲染页面的剩余部分。为此，通常应该把<code>&lt;script&gt;</code>元素放到页面末尾，介于主内容之后及<code>&lt;/body&gt;</code>标签之前。</li><li>可以使用<code>defer</code>属性将脚本推迟到文档解析完毕之后再执行。推迟的脚本原则上按照它们被列出的次序执行。</li><li>可以使用<code>async</code>属性表示脚本不需要等待其他脚本，同时也不阻塞文档渲染，即异步加载。异步脚本不能保证按照它们在页面中出现的顺序执行。</li><li>通过使用<code>&lt;noscript&gt;</code>元素，可以指定在浏览器不支持脚本时显示的内容。如果浏览器支持并启用脚本，则<code>&lt;noscript&gt;</code>元素中的任何内容都不会被渲染。</li></ul></article><div id="commentBoxScript"></div></main></main><div class="table-of-content"><div class="table-of-content-header"></div><div class="table-of-content-main"></div></div><div class="table-of-content-switch"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="bars" class="svg-inline--fa fa-bars " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"></path></svg></div></main><footer class="footer"><div class="wrapper"><div><h3>Thanks for reading!</h3><p>CopyRight © 2022 Louis K - Present</p></div><div><p style="font-size:1.3rem"><span><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="weixin" class="svg-inline--fa fa-weixin " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentColor" d="M385.2 167.6c6.4 0 12.6 .3 18.8 1.1C387.4 90.3 303.3 32 207.7 32 100.5 32 13 104.8 13 197.4c0 53.4 29.3 97.5 77.9 131.6l-19.3 58.6 68-34.1c24.4 4.8 43.8 9.7 68.2 9.7 6.2 0 12.1-.3 18.3-.8-4-12.9-6.2-26.6-6.2-40.8-.1-84.9 72.9-154 165.3-154zm-104.5-52.9c14.5 0 24.2 9.7 24.2 24.4 0 14.5-9.7 24.2-24.2 24.2-14.8 0-29.3-9.7-29.3-24.2 .1-14.7 14.6-24.4 29.3-24.4zm-136.4 48.6c-14.5 0-29.3-9.7-29.3-24.2 0-14.8 14.8-24.4 29.3-24.4 14.8 0 24.4 9.7 24.4 24.4 0 14.6-9.6 24.2-24.4 24.2zM563 319.4c0-77.9-77.9-141.3-165.4-141.3-92.7 0-165.4 63.4-165.4 141.3S305 460.7 397.6 460.7c19.3 0 38.9-5.1 58.6-9.9l53.4 29.3-14.8-48.6C534 402.1 563 363.2 563 319.4zm-219.1-24.5c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.8 0 24.4 9.7 24.4 19.3 0 10-9.7 19.6-24.4 19.6zm107.1 0c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.5 0 24.4 9.7 24.4 19.3 .1 10-9.9 19.6-24.4 19.6z"></path></svg></span><span><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="qq" class="svg-inline--fa fa-qq " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M433.8 420.4c-11.53 1.393-44.86-52.74-44.86-52.74 0 31.34-16.14 72.25-51.05 101.8 16.84 5.192 54.84 19.17 45.8 34.42-7.316 12.34-125.5 7.881-159.6 4.037-34.12 3.844-152.3 8.306-159.6-4.037-9.045-15.25 28.92-29.21 45.78-34.42-34.92-29.54-51.06-70.44-51.06-101.8 0 0-33.33 54.13-44.86 52.74-5.37-.65-12.42-29.64 9.347-99.7 10.26-33.02 21.1-60.48 40.14-105.8C60.68 98.06 108.1 .006 224 0c113.7 .006 163.2 96.13 160.3 214.1 18.12 45.22 29.91 72.85 40.14 105.8 21.77 70.06 14.72 99.05 9.346 99.7z"></path></svg></span><span><a href="mailto:k1664032884@gmail.com"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="envelope" class="svg-inline--fa fa-envelope " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 352c-16.53 0-33.06-5.422-47.16-16.41L0 173.2V400C0 426.5 21.49 448 48 448h416c26.51 0 48-21.49 48-48V173.2l-208.8 162.5C289.1 346.6 272.5 352 256 352zM16.29 145.3l212.2 165.1c16.19 12.6 38.87 12.6 55.06 0l212.2-165.1C505.1 137.3 512 125 512 112C512 85.49 490.5 64 464 64h-416C21.49 64 0 85.49 0 112C0 125 6.01 137.3 16.29 145.3z"></path></svg></a></span><span><a href="https://github.com/kqhasaki" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="github" class="svg-inline--fa fa-github " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3 .3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5 .3-6.2 2.3zm44.2-1.7c-2.9 .7-4.9 2.6-4.6 4.9 .3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3 .7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3 .3 2.9 2.3 3.9 1.6 1 3.6 .7 4.3-.7 .7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3 .7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3 .7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a></span></p></div></div></footer></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/articles/redbook-series/redbook-chapter02/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-a6a9e8476add1045c345.js"],"app":["/app-9219071c395ef3fffffa.js"],"component---src-pages-404-js":["/component---src-pages-404-js-a57028c9ca9b927c5051.js"],"component---src-pages-about-js":["/component---src-pages-about-js-839d876face1402d4ba3.js"],"component---src-pages-articles-mdx-slug-js":["/component---src-pages-articles-mdx-slug-js-7c025e8ce7d57a030f06.js"],"component---src-pages-index-js":["/component---src-pages-index-js-6af5eadfed50129b939a.js"],"component---src-pages-non-tech-js":["/component---src-pages-non-tech-js-fff71251e6fc458a81be.js"]};/*]]>*/</script><script src="/polyfill-a6a9e8476add1045c345.js" nomodule=""></script><script src="/component---src-pages-articles-mdx-slug-js-7c025e8ce7d57a030f06.js" async=""></script><script src="/commons-8aa8ea61781968697067.js" async=""></script><script src="/a9a7754c-d1e0ec91a76ed49794d7.js" async=""></script><script src="/cb1608f2-11f3b27bb6d43c4002d7.js" async=""></script><script src="/app-9219071c395ef3fffffa.js" async=""></script><script src="/framework-f27b074ecebec0f1dbc4.js" async=""></script><script src="/webpack-runtime-be4e6448a97e15bbfe34.js" async=""></script></body></html>